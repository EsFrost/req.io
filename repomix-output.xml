This file is a merged representation of the entire codebase, combined into a single document by Repomix.

<file_summary>
This section contains a summary of this file.

<purpose>
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.
</purpose>

<file_format>
The content is organized as follows:
1. This summary section
2. Repository information
3. Directory structure
4. Repository files (if enabled)
5. Multiple file entries, each consisting of:
  - File path as an attribute
  - Full contents of the file
</file_format>

<usage_guidelines>
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.
</usage_guidelines>

<notes>
- Some files may have been excluded based on .gitignore rules and Repomix's configuration
- Binary files are not included in this packed representation. Please refer to the Repository Structure section for a complete list of file paths, including binary files
- Files matching patterns in .gitignore are excluded
- Files matching default ignore patterns are excluded
- Files are sorted by Git change count (files with more changes are at the bottom)
</notes>

</file_summary>

<directory_structure>
.gitignore
index.html
LICENSE
package.json
readme.md
RR_temp.png
RR_temp.psd
src/main/index.ts
src/main/ipc/handlers.ts
src/main/ipc/request-handler.ts
src/main/security/encryption.ts
src/main/storage/collections.ts
src/main/storage/environments.ts
src/main/storage/history.ts
src/main/storage/projects.ts
src/main/storage/secure-projects.ts
src/main/window.ts
src/preload/index.ts
src/renderer/components/EnvironmentSelector.ts
src/renderer/components/RequestBuilder.ts
src/renderer/components/ResponseViewer.ts
src/renderer/components/Sidebar.ts
src/renderer/components/TabsManager.ts
src/renderer/helpers/breadcrumbs.ts
src/renderer/helpers/folder-tree.ts
src/renderer/helpers/key-value-renderer.ts
src/renderer/helpers/project-manager.ts
src/renderer/helpers/project-renderer.ts
src/renderer/helpers/request-builder.ts
src/renderer/helpers/request-context.ts
src/renderer/helpers/request-loader.ts
src/renderer/helpers/response-handler.ts
src/renderer/helpers/sidebar-renderer.ts
src/renderer/helpers/tab-manager.ts
src/renderer/helpers/variable-replacer.ts
src/renderer/index.ts
src/renderer/services/api.ts
src/renderer/services/storage.ts
src/renderer/types/index.ts
src/shared/types.ts
src/styles/input.css
tailwind.config.js
todo.md
tsconfig.json
tsconfig.renderer.json
</directory_structure>

<files>
This section contains the contents of the repository's files.

<file path="LICENSE">
MIT License

Copyright (c) 2025 Sigmund Frost

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
</file>

<file path="src/main/security/encryption.ts">
import { safeStorage } from 'electron';
import * as crypto from 'crypto';

export class SecureStorage {
  // Check if encryption is available
  static isEncryptionAvailable(): boolean {
    return safeStorage.isEncryptionAvailable();
  }

  // Encrypt sensitive data using OS keychain
  static encrypt(plainText: string): Buffer {
    if (!this.isEncryptionAvailable()) {
      console.warn('Encryption not available, storing in plain text');
      return Buffer.from(plainText);
    }
    return safeStorage.encryptString(plainText);
  }

  // Decrypt sensitive data
  static decrypt(encrypted: Buffer): string {
    if (!this.isEncryptionAvailable()) {
      return encrypted.toString();
    }
    return safeStorage.decryptString(encrypted);
  }

  // For storing in JSON files, convert Buffer to base64
  static encryptToBase64(plainText: string): string {
    const encrypted = this.encrypt(plainText);
    return encrypted.toString('base64');
  }

  static decryptFromBase64(base64: string): string {
    const buffer = Buffer.from(base64, 'base64');
    return this.decrypt(buffer);
  }
}

// Alternative: Custom encryption using a master password
export class CustomEncryption {
  private static algorithm = 'aes-256-gcm';
  
  // Derive key from master password
  private static deriveKey(password: string, salt: Buffer): Buffer {
    return crypto.pbkdf2Sync(password, salt, 100000, 32, 'sha256');
  }

  static encrypt(text: string, masterPassword: string): string {
    const salt = crypto.randomBytes(16);
    const key = this.deriveKey(masterPassword, salt);
    const iv = crypto.randomBytes(16);
    
    const cipher = crypto.createCipheriv(this.algorithm, key, iv) as crypto.CipherGCM;
    let encrypted = cipher.update(text, 'utf8', 'hex');
    encrypted += cipher.final('hex');
    
    const authTag = cipher.getAuthTag();
    
    // Combine salt, iv, authTag, and encrypted data
    return JSON.stringify({
      salt: salt.toString('hex'),
      iv: iv.toString('hex'),
      authTag: authTag.toString('hex'),
      data: encrypted
    });
  }

  static decrypt(encryptedData: string, masterPassword: string): string {
    const { salt, iv, authTag, data } = JSON.parse(encryptedData);
    
    const key = this.deriveKey(
      masterPassword,
      Buffer.from(salt, 'hex')
    );
    
    const decipher = crypto.createDecipheriv(
      this.algorithm,
      key,
      Buffer.from(iv, 'hex')
    ) as crypto.DecipherGCM;
    
    decipher.setAuthTag(Buffer.from(authTag, 'hex'));
    
    let decrypted = decipher.update(data, 'hex', 'utf8');
    decrypted += decipher.final('utf8');
    
    return decrypted;
  }
}
</file>

<file path="src/main/storage/projects.ts">
import { app } from 'electron';
import * as fs from 'fs';
import * as path from 'path';
import { Project } from '../../shared/types';

export class ProjectStorage {
  private storagePath: string;
  
  constructor() {
    const userDataPath = app.getPath('userData');
    this.storagePath = path.join(userDataPath, 'projects.json');
    this.ensureStorageFile();
  }
  
  private ensureStorageFile(): void {
    if (!fs.existsSync(this.storagePath)) {
      fs.writeFileSync(this.storagePath, JSON.stringify([]));
    }
  }
  
  loadAll(): Project[] {
    try {
      const data = fs.readFileSync(this.storagePath, 'utf-8');
      return JSON.parse(data);
    } catch {
      return [];
    }
  }
  
  save(project: Project): void {
    const projects = this.loadAll();
    const index = projects.findIndex(p => p.id === project.id);
    
    if (index >= 0) {
      projects[index] = { ...project, updatedAt: Date.now() };
    } else {
      projects.push(project);
    }
    
    fs.writeFileSync(this.storagePath, JSON.stringify(projects, null, 2));
  }
  
  delete(id: string): void {
    const projects = this.loadAll().filter(p => p.id !== id);
    fs.writeFileSync(this.storagePath, JSON.stringify(projects, null, 2));
  }
  
  get(id: string): Project | null {
    const projects = this.loadAll();
    return projects.find(p => p.id === id) || null;
  }
}
</file>

<file path="src/main/storage/secure-projects.ts">
import { app } from 'electron';
import * as fs from 'fs';
import * as path from 'path';
import { Project, Auth } from '../../shared/types';
import { SecureStorage } from '../security/encryption';

export class SecureProjectStorage {
  private storagePath: string;
  
  constructor() {
    const userDataPath = app.getPath('userData');
    this.storagePath = path.join(userDataPath, 'projects.json');
    this.ensureStorageFile();
  }
  
  private ensureStorageFile(): void {
    if (!fs.existsSync(this.storagePath)) {
        fs.writeFileSync(this.storagePath, JSON.stringify([]));
        
        // Set file permissions to 600 (owner read/write only)
        if (process.platform !== 'win32') {
        fs.chmodSync(this.storagePath, 0o600);
        }
    }
    }

  // Encrypt sensitive auth data before saving
  private encryptAuth(auth?: Auth): any {
    if (!auth) return undefined;

    const encrypted = { ...auth };
    
    if (auth.type === 'basic' && auth.basic) {
      encrypted.basic = {
        username: auth.basic.username,
        password: SecureStorage.encryptToBase64(auth.basic.password)
      };
    } else if (auth.type === 'bearer' && auth.bearer) {
      encrypted.bearer = {
        token: SecureStorage.encryptToBase64(auth.bearer.token)
      };
    } else if (auth.type === 'api-key' && auth.apiKey) {
      encrypted.apiKey = {
        ...auth.apiKey,
        value: SecureStorage.encryptToBase64(auth.apiKey.value)
      };
    }
    
    return encrypted;
  }

  // Decrypt sensitive auth data after loading
  private decryptAuth(auth?: any): Auth | undefined {
    if (!auth) return undefined;

    const decrypted = { ...auth };
    
    try {
      if (auth.type === 'basic' && auth.basic) {
        decrypted.basic = {
          username: auth.basic.username,
          password: SecureStorage.decryptFromBase64(auth.basic.password)
        };
      } else if (auth.type === 'bearer' && auth.bearer) {
        decrypted.bearer = {
          token: SecureStorage.decryptFromBase64(auth.bearer.token)
        };
      } else if (auth.type === 'api-key' && auth.apiKey) {
        decrypted.apiKey = {
          ...auth.apiKey,
          value: SecureStorage.decryptFromBase64(auth.apiKey.value)
        };
      }
    } catch (error) {
      console.error('Failed to decrypt auth data:', error);
    }
    
    return decrypted;
  }

  // Encrypt a project before saving
  private encryptProject(project: Project): any {
    const encrypted = { ...project };
    
    // Encrypt all request auth data
    encrypted.requests = project.requests.map(req => ({
      ...req,
      auth: this.encryptAuth(req.auth)
    }));
    
    // Encrypt requests in folders recursively
    const encryptFolders = (folders: any[]): any[] => {
      return folders.map(folder => ({
        ...folder,
        requests: folder.requests.map((req: any) => ({
          ...req,
          auth: this.encryptAuth(req.auth)
        })),
        subfolders: encryptFolders(folder.subfolders)
      }));
    };
    
    encrypted.folders = encryptFolders(project.folders);
    
    // Encrypt sensitive variables
    encrypted.variables = project.variables.map(v => ({
      ...v,
      value: v.sensitive ? SecureStorage.encryptToBase64(v.value) : v.value
    }));
    
    return encrypted;
  }

  // Decrypt a project after loading
  private decryptProject(project: any): Project {
    const decrypted = { ...project };
    
    // Decrypt all request auth data
    decrypted.requests = project.requests.map((req: any) => ({
      ...req,
      auth: this.decryptAuth(req.auth)
    }));
    
    // Decrypt requests in folders recursively
    const decryptFolders = (folders: any[]): any[] => {
      return folders.map(folder => ({
        ...folder,
        requests: folder.requests.map((req: any) => ({
          ...req,
          auth: this.decryptAuth(req.auth)
        })),
        subfolders: decryptFolders(folder.subfolders)
      }));
    };
    
    decrypted.folders = decryptFolders(project.folders);
    
    // Decrypt sensitive variables
    decrypted.variables = project.variables.map((v: any) => ({
      ...v,
      value: v.sensitive ? SecureStorage.decryptFromBase64(v.value) : v.value
    }));
    
    return decrypted;
  }
  
  loadAll(): Project[] {
    try {
      const data = fs.readFileSync(this.storagePath, 'utf-8');
      const projects = JSON.parse(data);
      return projects.map((p: any) => this.decryptProject(p));
    } catch {
      return [];
    }
  }
  
  save(project: Project): void {
    const projects = this.loadAll();
    const index = projects.findIndex(p => p.id === project.id);
    
    const updatedProject = { ...project, updatedAt: Date.now() };
    
    if (index >= 0) {
      projects[index] = updatedProject;
    } else {
      projects.push(updatedProject);
    }
    
    // Encrypt before saving
    const encryptedProjects = projects.map(p => this.encryptProject(p));
    
    fs.writeFileSync(this.storagePath, JSON.stringify(encryptedProjects, null, 2));
  }
  
  delete(id: string): void {
    const projects = this.loadAll().filter(p => p.id !== id);
    const encryptedProjects = projects.map(p => this.encryptProject(p));
    fs.writeFileSync(this.storagePath, JSON.stringify(encryptedProjects, null, 2));
  }
  
  get(id: string): Project | null {
    const projects = this.loadAll();
    return projects.find(p => p.id === id) || null;
  }
}
</file>

<file path="src/renderer/helpers/project-manager.ts">
import { Project, Folder, Request } from '../../shared/types';

export function findFolder(folders: Folder[], folderId: string): Folder | null {
  for (const folder of folders) {
    if (folder.id === folderId) return folder;
    const found = findFolder(folder.subfolders, folderId);
    if (found) return found;
  }
  return null;
}

export function deleteFolder(project: Project, folderId: string): void {
  const removeFolder = (folders: Folder[]): Folder[] => {
    return folders.filter(f => {
      if (f.id === folderId) return false;
      f.subfolders = removeFolder(f.subfolders);
      return true;
    });
  };
  
  project.folders = removeFolder(project.folders);
}

export function deleteRequest(project: Project, requestId: string): void {
  project.requests = project.requests.filter(r => r.id !== requestId);
  
  const removeFromFolders = (folders: Folder[]) => {
    folders.forEach(folder => {
      folder.requests = folder.requests.filter(r => r.id !== requestId);
      removeFromFolders(folder.subfolders);
    });
  };
  
  removeFromFolders(project.folders);
}

export function createFolder(
  name: string,
  projectId: string,
  parentId?: string
): Folder {
  return {
    id: Date.now().toString(),
    name,
    parentId,
    projectId,
    requests: [],
    subfolders: [],
    createdAt: Date.now(),
    updatedAt: Date.now()
  };
}

export function createRequest(projectId: string, folderId?: string): Request {
  return {
    id: Date.now().toString(),
    name: 'Untitled Request',
    method: 'GET',
    url: '',
    headers: [],
    queryParams: [],
    projectId,
    folderId,
    createdAt: Date.now(),
    updatedAt: Date.now()
  };
}

export function addFolderToProject(
  project: Project,
  folder: Folder,
  parentId?: string
): void {
  if (parentId) {
    const parentFolder = findFolder(project.folders, parentId);
    if (parentFolder) {
      parentFolder.subfolders.push(folder);
    }
  } else {
    project.folders.push(folder);
  }
}

export function addRequestToProject(
  project: Project,
  request: Request,
  folderId?: string
): void {
  if (folderId) {
    const folder = findFolder(project.folders, folderId);
    if (folder) {
      folder.requests.push(request);
    }
  } else {
    project.requests.push(request);
  }
}
</file>

<file path="src/renderer/helpers/variable-replacer.ts">
import { Project } from '../../shared/types';

export function replaceVariables(text: string, project: Project | null): string {
  if (!project) return text;
  
  let result = text;
  
  // Replace {{baseUrl}}
  if (project.baseUrl) {
    result = result.replace(/\{\{baseUrl\}\}/g, project.baseUrl);
  }
  
  // Replace custom variables
  project.variables.forEach(variable => {
    if (variable.enabled && variable.key) {
      const regex = new RegExp(`\\{\\{${variable.key}\\}\\}`, 'g');
      result = result.replace(regex, variable.value || '');
    }
  });
  
  return result;
}
</file>

<file path="src/main/index.ts">
import { app, BrowserWindow } from 'electron';
import { createWindow } from './window';
import { registerHandlers } from './ipc/handlers';

app.on('ready', () => {
  registerHandlers();
  createWindow();

  app.on('activate', () => {
    if (BrowserWindow.getAllWindows().length === 0) {
      createWindow();
    }
  });
});

app.on('window-all-closed', () => {
  if (process.platform !== 'darwin') {
    app.quit();
  }
});
</file>

<file path="src/main/storage/collections.ts">
import { app } from 'electron';
import * as fs from 'fs';
import * as path from 'path';
import { Collection } from '../../shared/types';

export class CollectionStorage {
  private storagePath: string;
  
  constructor() {
    const userDataPath = app.getPath('userData');
    this.storagePath = path.join(userDataPath, 'collections.json');
    this.ensureStorageFile();
  }
  
  private ensureStorageFile(): void {
    if (!fs.existsSync(this.storagePath)) {
      fs.writeFileSync(this.storagePath, JSON.stringify([]));
    }
  }
  
  loadAll(): Collection[] {
    try {
      const data = fs.readFileSync(this.storagePath, 'utf-8');
      return JSON.parse(data);
    } catch {
      return [];
    }
  }
  
  save(collection: Collection): void {
    const collections = this.loadAll();
    const index = collections.findIndex(c => c.id === collection.id);
    
    if (index >= 0) {
      collections[index] = { ...collection, updatedAt: Date.now() };
    } else {
      collections.push(collection);
    }
    
    fs.writeFileSync(this.storagePath, JSON.stringify(collections, null, 2));
  }
  
  delete(id: string): void {
    const collections = this.loadAll().filter(c => c.id !== id);
    fs.writeFileSync(this.storagePath, JSON.stringify(collections, null, 2));
  }
}
</file>

<file path="src/main/storage/environments.ts">
import { app } from 'electron';
import * as fs from 'fs';
import * as path from 'path';
import { Environment } from '../../shared/types';

export class EnvironmentStorage {
  private storagePath: string;
  
  constructor() {
    const userDataPath = app.getPath('userData');
    this.storagePath = path.join(userDataPath, 'environments.json');
    this.ensureStorageFile();
  }
  
  private ensureStorageFile(): void {
    if (!fs.existsSync(this.storagePath)) {
      fs.writeFileSync(this.storagePath, JSON.stringify([]));
    }
  }
  
  loadAll(): Environment[] {
    try {
      const data = fs.readFileSync(this.storagePath, 'utf-8');
      return JSON.parse(data);
    } catch {
      return [];
    }
  }
  
  save(environment: Environment): void {
    const environments = this.loadAll();
    const index = environments.findIndex(e => e.id === environment.id);
    
    if (index >= 0) {
      environments[index] = environment;
    } else {
      environments.push(environment);
    }
    
    fs.writeFileSync(this.storagePath, JSON.stringify(environments, null, 2));
  }
  
  delete(id: string): void {
    const environments = this.loadAll().filter(e => e.id !== id);
    fs.writeFileSync(this.storagePath, JSON.stringify(environments, null, 2));
  }
  
  setActive(id: string): void {
    const environments = this.loadAll();
    environments.forEach(e => {
      e.isActive = e.id === id;
    });
    fs.writeFileSync(this.storagePath, JSON.stringify(environments, null, 2));
  }
}
</file>

<file path="src/main/storage/history.ts">
import { app } from 'electron';
import * as fs from 'fs';
import * as path from 'path';
import { HistoryEntry } from '../../shared/types';

export class HistoryStorage {
  private storagePath: string;
  private maxEntries = 100;
  
  constructor() {
    const userDataPath = app.getPath('userData');
    this.storagePath = path.join(userDataPath, 'history.json');
    this.ensureStorageFile();
  }
  
  private ensureStorageFile(): void {
    if (!fs.existsSync(this.storagePath)) {
      fs.writeFileSync(this.storagePath, JSON.stringify([]));
    }
  }
  
  get(limit?: number): HistoryEntry[] {
    try {
      const data = fs.readFileSync(this.storagePath, 'utf-8');
      const history = JSON.parse(data);
      return limit ? history.slice(0, limit) : history;
    } catch {
      return [];
    }
  }
  
  add(entry: HistoryEntry): void {
    const history = this.get();
    history.unshift(entry);
    
    // Keep only the most recent entries
    const trimmed = history.slice(0, this.maxEntries);
    
    fs.writeFileSync(this.storagePath, JSON.stringify(trimmed, null, 2));
  }
  
  clear(): void {
    fs.writeFileSync(this.storagePath, JSON.stringify([]));
  }
}
</file>

<file path="src/renderer/helpers/breadcrumbs.ts">
import { Project, Folder } from '../../shared/types';
import { findFolder } from './project-manager';

export interface BreadcrumbItem {
  id: string;
  name: string;
  type: 'project' | 'folder';
}

export function getBreadcrumbs(
  project: Project | null,
  folderId?: string
): BreadcrumbItem[] {
  const breadcrumbs: BreadcrumbItem[] = [];
  
  if (!project) {
    return breadcrumbs;
  }
  
  breadcrumbs.push({
    id: project.id,
    name: project.name,
    type: 'project'
  });
  
  if (folderId) {
    const folder = findFolder(project.folders, folderId);
    if (folder) {
      // Build path from root to this folder
      const path = getFolderPath(project.folders, folderId);
      path.forEach(f => {
        breadcrumbs.push({
          id: f.id,
          name: f.name,
          type: 'folder'
        });
      });
    }
  }
  
  return breadcrumbs;
}

function getFolderPath(folders: Folder[], targetId: string, currentPath: Folder[] = []): Folder[] {
  for (const folder of folders) {
    if (folder.id === targetId) {
      return [...currentPath, folder];
    }
    
    const found = getFolderPath(folder.subfolders, targetId, [...currentPath, folder]);
    if (found.length > 0 && found[found.length - 1].id === targetId) {
      return found;
    }
  }
  
  return [];
}

export function renderBreadcrumbs(
  container: HTMLElement,
  breadcrumbs: BreadcrumbItem[]
): void {
  container.innerHTML = '';
  
  if (breadcrumbs.length === 0) {
    container.innerHTML = '<span class="text-gray-500 text-sm">No Project</span>';
    return;
  }
  
  breadcrumbs.forEach((item, index) => {
    const breadcrumb = document.createElement('span');
    breadcrumb.className = 'text-sm';
    
    if (index > 0) {
      const separator = document.createElement('span');
      separator.className = 'text-gray-500 mx-2';
      separator.textContent = '/';
      container.appendChild(separator);
    }
    
    breadcrumb.textContent = item.name;
    breadcrumb.className = index === breadcrumbs.length - 1 
      ? 'text-white text-sm font-semibold' 
      : 'text-gray-400 text-sm cursor-pointer hover:underline';
    
    container.appendChild(breadcrumb);
  });
}
</file>

<file path="src/renderer/helpers/folder-tree.ts">
import { Folder } from '../../shared/types';

export function renderFolderTree(
  container: HTMLElement,
  folders: Folder[],
  onSelect: (folderId: string) => void,
  depth: number = 0
): void {
  folders.forEach(folder => {
    const folderBtn = document.createElement('button');
    folderBtn.className = 'w-full bg-[rgba(7,14,29,0.5)] hover:bg-gray-800 p-2 rounded mb-1 text-left flex items-center gap-2 transition-all duration-300';
    folderBtn.style.marginLeft = `${depth * 20}px`;
    
    const icon = document.createElement('span');
    icon.innerHTML = `<svg class="w-5 h-5 inline-block mb-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M3 8.2C3 7.07989 3 6.51984 3.21799 6.09202C3.40973 5.71569 3.71569 5.40973 4.09202 5.21799C4.51984 5 5.0799 5 6.2 5H9.67452C10.1637 5 10.4083 5 10.6385 5.05526C10.8425 5.10425 11.0376 5.18506 11.2166 5.29472C11.4184 5.4184 11.5914 5.59135 11.9373 5.93726L12.0627 6.06274C12.4086 6.40865 12.5816 6.5816 12.7834 6.70528C12.9624 6.81494 13.1575 6.89575 13.3615 6.94474C13.5917 7 13.8363 7 14.3255 7H17.8C18.9201 7 19.4802 7 19.908 7.21799C20.2843 7.40973 20.5903 7.71569 20.782 8.09202C21 8.51984 21 9.0799 21 10.2V15.8C21 16.9201 21 17.4802 20.782 17.908C20.5903 18.2843 20.2843 18.5903 19.908 18.782C19.4802 19 18.9201 19 17.8 19H6.2C5.07989 19 4.51984 19 4.09202 18.782C3.71569 18.5903 3.40973 18.2843 3.21799 17.908C3 17.4802 3 16.9201 3 15.8V8.2Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>`;
    
    const name = document.createElement('span');
    name.textContent = folder.name;
    name.className = 'text-sm';
    
    folderBtn.appendChild(icon);
    folderBtn.appendChild(name);
    
    folderBtn.onclick = () => onSelect(folder.id);
    
    container.appendChild(folderBtn);
    
    // Render subfolders
    if (folder.subfolders.length > 0) {
      renderFolderTree(container, folder.subfolders, onSelect, depth + 1);
    }
  });
}
</file>

<file path="src/renderer/helpers/project-renderer.ts">
import { Project } from '../../shared/types';

export interface ProjectCallbacks {
  onLoadProject: (projectId: string) => void;
  onEditProject: (project: Project) => void;
  onExportProject: (project: Project) => void;
  onDeleteProject: (projectId: string) => void;
}

export function renderProjectList(
  container: HTMLDivElement,
  projects: Project[],
  callbacks: ProjectCallbacks
): void {
  container.innerHTML = '';
  
  if (projects.length === 0) {
    container.innerHTML = '<div class="text-gray-400 text-center py-8 bg-[rgba(7,14,29,0.7)]">No projects yet. Create one to get started!</div>';
    return;
  }
  
  projects.forEach(project => {
    const projectCard = document.createElement('div');
    projectCard.className = 'bg-[rgba(7,14,29,0.7)] p-4 rounded mb-3 hover:bg-gray-750 cursor-pointer';
    
    projectCard.innerHTML = `
      <div class="flex justify-between items-start mb-2">
        <div class="flex-1">
          <h3 class="text-lg font-semibold text-white mb-1">${project.name}</h3>
          ${project.description ? `<p class="text-sm text-gray-400 mb-2">${project.description}</p>` : ''}
          ${project.baseUrl ? `<p class="text-xs text-blue-400">Base URL: ${project.baseUrl}</p>` : ''}
        </div>
        <div class="flex gap-2">
          <button class="edit-project px-3 py-1 text-sm overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10">Edit</button>
          <button class="export-project px-3 py-1 overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10 text-sm">Export</button>
          <button class="delete-project px-3 py-1 overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10 text-sm">Delete</button>
        </div>
      </div>
      <div class="text-xs text-gray-500">
        ${project.folders.length} folder(s), ${project.requests.length} request(s)
      </div>
    `;
    
    projectCard.onclick = (e) => {
      if (!(e.target as HTMLElement).classList.contains('edit-project') && 
          !(e.target as HTMLElement).classList.contains('delete-project') &&
          !(e.target as HTMLElement).classList.contains('export-project')) {
        callbacks.onLoadProject(project.id);
      }
    };
    
    projectCard.querySelector('.edit-project')?.addEventListener('click', (e) => {
      e.stopPropagation();
      callbacks.onEditProject(project);
    });
    
    projectCard.querySelector('.export-project')?.addEventListener('click', async (e) => {
      e.stopPropagation();
      callbacks.onExportProject(project);
    });
    
    projectCard.querySelector('.delete-project')?.addEventListener('click', async (e) => {
      e.stopPropagation();
      callbacks.onDeleteProject(project.id);
    });
    
    container.appendChild(projectCard);
  });
}
</file>

<file path="src/renderer/helpers/request-builder.ts">
import { Request, HttpMethod, KeyValue, BodyType, AuthType } from '../../shared/types';

export const methodColors: Record<HttpMethod, string> = {
  'GET': 'text-green-600',
  'POST': 'text-yellow-600',
  'PUT': 'text-blue-600',
  'PATCH': 'text-pink-600',
  'DELETE': 'text-red-600',
  'HEAD': 'text-green-400',
  'OPTIONS': 'text-purple-600'
};

export function isHttpMethod(method: string): method is HttpMethod {
  return ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'HEAD', 'OPTIONS'].includes(method);
}

export function buildRequest(
  currentMethod: HttpMethod,
  urlInput: HTMLInputElement,
  paramsContainer: HTMLDivElement,
  headersContainer: HTMLDivElement,
  bodyTypeSelect: HTMLSelectElement,
  bodyRawTextarea: HTMLTextAreaElement,
  bodyJsonTextarea: HTMLTextAreaElement,
  bodyFormDataContainer: HTMLDivElement,
  authTypeSelect: HTMLSelectElement,
  projectId?: string
): Request {
  // Get query params from inputs
  const paramRows = paramsContainer.querySelectorAll('.flex');
  const currentParams: KeyValue[] = [];
  paramRows.forEach(row => {
    const checkbox = row.querySelector('input[type="checkbox"]') as HTMLInputElement;
    const keyInput = row.querySelector('[data-key-input]') as HTMLInputElement;
    const valueInput = row.querySelector('[data-value-input]') as HTMLInputElement;
    
    if (checkbox && keyInput && valueInput) {
      currentParams.push({
        key: keyInput.value,
        value: valueInput.value,
        enabled: checkbox.checked
      });
    }
  });
  
  // Get headers from inputs
  const headerRows = headersContainer.querySelectorAll('.flex');
  const currentHeaders: KeyValue[] = [];
  headerRows.forEach(row => {
    const checkbox = row.querySelector('input[type="checkbox"]') as HTMLInputElement;
    const keyInput = row.querySelector('[data-key-input]') as HTMLInputElement;
    const valueInput = row.querySelector('[data-value-input]') as HTMLInputElement;
    
    if (checkbox && keyInput && valueInput) {
      currentHeaders.push({
        key: keyInput.value,
        value: valueInput.value,
        enabled: checkbox.checked
      });
    }
  });
  
  // Build body
  const bodyType = bodyTypeSelect.value as BodyType;
  let body: Request['body'];
  
  if (bodyType === 'none') {
    body = undefined;
  } else if (bodyType === 'raw' || bodyType === 'x-www-form-urlencoded') {
    body = { type: bodyType, raw: bodyRawTextarea.value };
  } else if (bodyType === 'json') {
    body = { type: bodyType, json: bodyJsonTextarea.value };
  } else if (bodyType === 'form-data') {
    const formRows = bodyFormDataContainer.querySelectorAll('.flex');
    const formData: KeyValue[] = [];
    formRows.forEach(row => {
      const checkbox = row.querySelector('input[type="checkbox"]') as HTMLInputElement;
      const keyInput = row.querySelector('[data-key-input]') as HTMLInputElement;
      const valueInput = row.querySelector('[data-value-input]') as HTMLInputElement;
      
      if (checkbox && keyInput && valueInput) {
        formData.push({
          key: keyInput.value,
          value: valueInput.value,
          enabled: checkbox.checked
        });
      }
    });
    body = { type: bodyType, formData };
  }
  
  // Build auth
  const authType = authTypeSelect.value as AuthType;
  let auth: Request['auth'];
  
  if (authType === 'none') {
    auth = undefined;
  } else if (authType === 'basic') {
    const username = (document.getElementById('auth-basic-username') as HTMLInputElement).value;
    const password = (document.getElementById('auth-basic-password') as HTMLInputElement).value;
    auth = { type: authType, basic: { username, password } };
  } else if (authType === 'bearer') {
    const token = (document.getElementById('auth-bearer-token') as HTMLInputElement).value;
    auth = { type: authType, bearer: { token } };
  } else if (authType === 'api-key') {
    const key = (document.getElementById('auth-apikey-key') as HTMLInputElement).value;
    const value = (document.getElementById('auth-apikey-value') as HTMLInputElement).value;
    const addTo = (document.getElementById('auth-apikey-addto') as HTMLSelectElement).value as 'header' | 'query';
    auth = { type: authType, apiKey: { key, value, addTo } };
  }
  
  return {
    id: Date.now().toString(),
    name: 'Untitled Request',
    method: currentMethod,
    url: urlInput.value,
    headers: currentHeaders,
    body,
    auth,
    queryParams: currentParams,
    projectId,
    createdAt: Date.now(),
    updatedAt: Date.now()
  };
}
</file>

<file path="src/renderer/helpers/request-context.ts">
import { Request, Project, Folder } from '../../shared/types';
import { findFolder } from './project-manager';

export interface RequestContext {
  request: Request;
  projectId?: string;
  folderId?: string;
  isInProject: boolean;
}

export function getRequestContext(request: Request): RequestContext {
  return {
    request,
    projectId: request.projectId,
    folderId: request.folderId,
    isInProject: !!request.projectId
  };
}

export function saveRequestToProject(
  request: Request,
  project: Project,
  folderId?: string
): void {
  // Remove request from old location if it exists
  removeRequestFromProject(project, request.id);
  
  // Update request context
  request.projectId = project.id;
  request.folderId = folderId;
  request.updatedAt = Date.now();
  
  // Add to new location
  if (folderId) {
    const folder = findFolder(project.folders, folderId);
    if (folder) {
      folder.requests.push(request);
    }
  } else {
    project.requests.push(request);
  }
}

export function updateRequestInProject(
  request: Request,
  project: Project
): boolean {
  if (!request.projectId || request.projectId !== project.id) {
    return false;
  }
  
  request.updatedAt = Date.now();
  
  if (request.folderId) {
    const folder = findFolder(project.folders, request.folderId);
    if (folder) {
      const index = folder.requests.findIndex(r => r.id === request.id);
      if (index >= 0) {
        folder.requests[index] = { ...request };
        return true;
      }
    }
  } else {
    const index = project.requests.findIndex(r => r.id === request.id);
    if (index >= 0) {
      project.requests[index] = { ...request };
      return true;
    }
  }
  
  return false;
}

function removeRequestFromProject(project: Project, requestId: string): void {
  // Remove from root
  project.requests = project.requests.filter(r => r.id !== requestId);
  
  // Remove from all folders
  const removeFromFolders = (folders: Folder[]) => {
    folders.forEach(folder => {
      folder.requests = folder.requests.filter(r => r.id !== requestId);
      removeFromFolders(folder.subfolders);
    });
  };
  
  removeFromFolders(project.folders);
}
</file>

<file path="src/renderer/helpers/request-loader.ts">
import { Request, HttpMethod } from '../../shared/types';
import { isHttpMethod } from './request-builder';

export function loadRequestIntoUI(
  request: Request,
  elements: {
    urlInput: HTMLInputElement;
    paramsContainer: HTMLDivElement;
    headersContainer: HTMLDivElement;
    bodyTypeSelect: HTMLSelectElement;
    bodyRawTextarea: HTMLTextAreaElement;
    bodyJsonTextarea: HTMLTextAreaElement;
    bodyFormDataContainer: HTMLDivElement;
    authTypeSelect: HTMLSelectElement;
  },
  renderers: {
    renderParams: () => void;
    renderHeaders: () => void;
    renderFormFields: () => void;
  },
  setters: {
    setMethod: (method: HttpMethod) => void;
    setQueryParams: (params: any[]) => void;
    setHeaders: (headers: any[]) => void;
    setFormFields: (fields: any[]) => void;
  }
): void {
  // Populate URL
  elements.urlInput.value = request.url || '';
  
  // Set method
  if (request.method && isHttpMethod(request.method)) {
    setters.setMethod(request.method);
  }
  
  // Populate query params
  setters.setQueryParams(request.queryParams || []);
  renderers.renderParams();
  
  // Populate headers
  setters.setHeaders(request.headers || []);
  renderers.renderHeaders();
  
  // Populate body
  if (request.body) {
    elements.bodyTypeSelect.value = request.body.type;
    elements.bodyTypeSelect.dispatchEvent(new Event('change'));
    
    switch (request.body.type) {
      case 'raw':
      case 'x-www-form-urlencoded':
        elements.bodyRawTextarea.value = request.body.raw || '';
        break;
      case 'json':
        elements.bodyJsonTextarea.value = typeof request.body.json === 'string' 
          ? request.body.json 
          : JSON.stringify(request.body.json, null, 2);
        break;
      case 'form-data':
        setters.setFormFields(request.body.formData || []);
        renderers.renderFormFields();
        break;
    }
  } else {
    elements.bodyTypeSelect.value = 'none';
    elements.bodyTypeSelect.dispatchEvent(new Event('change'));
  }
  
  // Populate auth
  if (request.auth) {
    elements.authTypeSelect.value = request.auth.type;
    elements.authTypeSelect.dispatchEvent(new Event('change'));
    
    switch (request.auth.type) {
      case 'basic':
        if (request.auth.basic) {
          (document.getElementById('auth-basic-username') as HTMLInputElement).value = request.auth.basic.username || '';
          (document.getElementById('auth-basic-password') as HTMLInputElement).value = request.auth.basic.password || '';
        }
        break;
      case 'bearer':
        if (request.auth.bearer) {
          (document.getElementById('auth-bearer-token') as HTMLInputElement).value = request.auth.bearer.token || '';
        }
        break;
      case 'api-key':
        if (request.auth.apiKey) {
          (document.getElementById('auth-apikey-key') as HTMLInputElement).value = request.auth.apiKey.key || '';
          (document.getElementById('auth-apikey-value') as HTMLInputElement).value = request.auth.apiKey.value || '';
          (document.getElementById('auth-apikey-addto') as HTMLSelectElement).value = request.auth.apiKey.addTo || 'header';
        }
        break;
    }
  } else {
    elements.authTypeSelect.value = 'none';
    elements.authTypeSelect.dispatchEvent(new Event('change'));
  }
}
</file>

<file path="src/renderer/helpers/response-handler.ts">
import hljs from 'highlight.js';
import { HttpResponse } from '../../shared/types';

export type DisplayFormat = 'raw' | 'json' | 'html' | 'xml';

export const getStatusText = (code: number): string => {
  const statusTexts: Record<number, string> = {
    200: 'OK', 201: 'Created', 204: 'No Content',
    301: 'Moved Permanently', 302: 'Found', 304: 'Not Modified',
    400: 'Bad Request', 401: 'Unauthorized', 403: 'Forbidden',
    404: 'Not Found', 405: 'Method Not Allowed',
    500: 'Internal Server Error', 502: 'Bad Gateway',
    503: 'Service Unavailable', 504: 'Gateway Timeout'
  };
  return statusTexts[code] || 'Unknown';
};

export const detectLanguage = (data: string): string => {
  const trimmed = data.trim();
  
  if ((trimmed.startsWith('{') && trimmed.endsWith('}')) || 
      (trimmed.startsWith('[') && trimmed.endsWith(']'))) {
    try {
      JSON.parse(trimmed);
      return 'json';
    } catch {}
  }
  
  if (trimmed.startsWith('<?xml') || 
      (trimmed.startsWith('<') && trimmed.includes('</') && trimmed.endsWith('>'))) {
    return 'xml';
  }
  
  if (trimmed.toLowerCase().includes('<!doctype html') || 
      trimmed.toLowerCase().includes('<html')) {
    return 'html';
  }
  
  return 'plaintext';
};

export const displayResponse = (
  response: HttpResponse,
  currentFormat: DisplayFormat,
  resultDiv: HTMLDivElement,
  statusCodeSpan: HTMLSpanElement,
  responseTimeSpan: HTMLSpanElement,
  responseSizeSpan: HTMLSpanElement
): void => {
  resultDiv.innerHTML = '';
  
  const codeBlock = document.createElement('pre');
  codeBlock.style.margin = '0';
  codeBlock.style.width = '100%';
  codeBlock.style.overflow = 'visible';
  
  const codeElement = document.createElement('code');
  codeElement.style.display = 'block';
  codeElement.style.padding = '1rem';
  codeElement.style.whiteSpace = 'pre';
  codeElement.style.overflowWrap = 'normal';
  codeElement.style.wordBreak = 'normal';
  codeElement.style.setProperty('background-color', 'rgba(7,14,29,0.7)', 'important');
  
  const data = response.body;
  
  switch (currentFormat) {
    case 'raw':
      const detectedLang = detectLanguage(data);
      codeElement.className = `language-${detectedLang}`;
      codeElement.textContent = data;
      break;
      
    case 'json':
      try {
        const parsed = JSON.parse(data);
        const formatted = JSON.stringify(parsed, null, 2);
        codeElement.className = 'language-json';
        codeElement.textContent = formatted;
      } catch {
        codeElement.className = 'language-plaintext';
        codeElement.textContent = 'Invalid JSON: ' + data;
      }
      break;
      
    case 'html':
      codeElement.className = 'language-html';
      codeElement.textContent = data;
      break;
      
    case 'xml':
      codeElement.className = 'language-xml';
      codeElement.textContent = data;
      break;
  }
  
  codeBlock.appendChild(codeElement);
  resultDiv.appendChild(codeBlock);
  hljs.highlightElement(codeElement);
  
  statusCodeSpan.textContent = `${response.status} ${response.statusText}`;
  statusCodeSpan.className = response.status >= 200 && response.status < 300 
    ? 'text-green-400 font-semibold' 
    : 'text-red-400 font-semibold';
  
  responseTimeSpan.textContent = `${response.time.toFixed(0)}ms`;
  responseSizeSpan.textContent = `${(response.size / 1024).toFixed(2)}KB`;
};
</file>

<file path="src/renderer/helpers/tab-manager.ts">
import { Request, HttpResponse, HttpMethod } from '../../shared/types';

export interface Tab {
  id: string;
  name: string;
  request: Request;
  response: HttpResponse | null;
}

export class TabManager {
  private tabs: Tab[] = [];
  private activeTabId: string = '';
  private tabsContainer: HTMLDivElement;
  private onTabChange: (tabId: string) => void;

  constructor(tabsContainer: HTMLDivElement, onTabChange: (tabId: string) => void) {
    this.tabsContainer = tabsContainer;
    this.onTabChange = onTabChange;
  }

  createTab(request: Request): string {
    const tab: Tab = {
      id: Date.now().toString(),
      name: 'New Request',
      request,
      response: null
    };
    
    this.tabs.push(tab);
    this.activeTabId = tab.id;
    this.render();
    return tab.id;
  }

  closeTab(tabId: string): void {
    if (this.tabs.length === 1) return;
    
    const index = this.tabs.findIndex(t => t.id === tabId);
    if (index === -1) return;
    
    this.tabs.splice(index, 1);
    
    if (this.activeTabId === tabId) {
      this.activeTabId = this.tabs[Math.max(0, index - 1)].id;
    }
    
    this.render();
    this.onTabChange(this.activeTabId);
  }

  setActiveTab(tabId: string): void {
    this.activeTabId = tabId;
    this.render();
    this.onTabChange(tabId);
  }

  getActiveTab(): Tab | null {
    return this.tabs.find(t => t.id === this.activeTabId) || null;
  }

  updateActiveTab(request: Request, response: HttpResponse | null): void {
    const tab = this.getActiveTab();
    if (!tab) return;
    
    tab.request = request;
    tab.response = response;
    
    // Update tab name based on URL
    if (request.url) {
      try {
        const url = new URL(request.url);
        const urlPath = url.pathname.split('/').filter(p => p).join('/') || url.hostname;
        tab.name = `${request.method} ${urlPath.substring(0, 20)}${urlPath.length > 20 ? '...' : ''}`;
      } catch {
        tab.name = `${request.method} Request`;
      }
    } else {
      tab.name = 'New Request';
    }
    
    this.render();
  }

  getTabs(): Tab[] {
    return this.tabs;
  }

  getActiveTabId(): string {
    return this.activeTabId;
  }

  private render(): void {
    this.tabsContainer.innerHTML = '';
    
    this.tabs.forEach(tab => {
      const tabElement = document.createElement('div');
      tabElement.className = `flex items-center gap-2 px-4 py-2 rounded-t cursor-pointer transition-all duration-300 ${
        this.activeTabId === tab.id ? 'bg-[rgba(7,14,29,0.7)] text-white hover:bg-[rgba(7,14,29,0.9)]' : 'bg-gray-700 text-gray-400 hover:bg-[rgba(7,14,29,0.9)]'
      }`;
      
      const tabName = document.createElement('span');
      tabName.textContent = tab.name;
      tabName.className = 'text-sm';
      
      const closeBtn = document.createElement('button');
      closeBtn.textContent = 'Ã—';
      closeBtn.className = 'text-lg hover:text-red-400 ml-2';
      closeBtn.onclick = (e) => {
        e.stopPropagation();
        this.closeTab(tab.id);
      };
      
      tabElement.onclick = () => {
        this.setActiveTab(tab.id);
      };
      
      tabElement.appendChild(tabName);
      if (this.tabs.length > 1) {
        tabElement.appendChild(closeBtn);
      }
      
      this.tabsContainer.appendChild(tabElement);
    });
  }
}
</file>

<file path="tailwind.config.js">
module.exports = {
  content: ["./*.html", "./dist/**/*.js"],
  theme: {
    extend: {},
  },
  plugins: [],
}
</file>

<file path="tsconfig.renderer.json">
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ES2020",
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "moduleResolution": "bundler",
    "resolveJsonModule": true
  },
  "include": ["src/renderer/**/*", "src/shared/**/*"],
  "exclude": ["node_modules"]
}
</file>

<file path=".gitignore">
node_modules
/node_modules
*node_modules/*

release
/release
*release/*

styles.css

dist
</file>

<file path="readme.md">
# Req-Rep.io

## Req-Rep.io is a simple HTTP client for Windows, Linux and macOS.

It was created using the Electron framework which I have worked with before and I find using it faster, easier and more enjoyable to develop with.

## Why Req-Rep.io ?

This is an open source project, feel free to fork, download, modify etc. You have absolute control over what is happening. It can be used as a base for a much more complex and complete project.

### Why not Postman ?

Req-Rep.io does not use any sort of accounts, does not collect any sort of data and is completely free, while maintaining similar functionality to Postman. If there are any features missing you can either add them yourself or suggest the change and I will try to implement it.

### Why not curl ?

In case you want an intuitive app with GUI since curl is a command line tool and you might not want to remember all the flags and options. On the other hand, as mentioned before, if any command or flag is missing, you can always add it yourself or request for it to be added.

*I hope you find this project useful, intuitive, easy to use, easy to modify and instructive.*

---

If the final project's size is too large, please download the source code and build it yourself.

Any and all suggestions are welcome.
</file>

<file path="src/main/window.ts">
import { BrowserWindow, Menu, ipcMain, app } from 'electron';
import path from 'path';

export const createWindow = (): BrowserWindow => {
  let iconPath: string;
  
  if (app.isPackaged) {
    
    if (process.platform === 'win32') {
      iconPath = path.join(process.resourcesPath, 'app.asar.unpacked', 'build', 'icons', 'win', 'icon.ico');
    } else if (process.platform === 'darwin') {
      iconPath = path.join(process.resourcesPath, 'build', 'icons', 'mac', 'icon.icns');
    } else {
      iconPath = path.join(process.resourcesPath, 'build', 'icons', 'png', '512x512.png');
    }
  } else {
    if (process.platform === 'win32') {
      iconPath = path.join(__dirname, '../../build/icons/win/icon.ico');
    } else if (process.platform === 'darwin') {
      iconPath = path.join(__dirname, '../../build/icons/mac/icon.icns');
    } else {
      iconPath = path.join(__dirname, '../../build/icons/png/512x512.png');
    }
  }

  const win = new BrowserWindow({
    width: 1200,
    height: 800,
    icon: iconPath,
    webPreferences: {
      preload: path.join(__dirname, '../preload/index.js'),
      nodeIntegration: false,
      contextIsolation: true,
    },
  });

  // Hide the menu by default
  win.setMenuBarVisibility(false);
  
  win.loadFile('index.html');

  // Handle menu toggle
  ipcMain.on('toggle-menu', () => {
    const isVisible = win.isMenuBarVisible();
    win.setMenuBarVisibility(!isVisible);
  });
  
  return win;
};
</file>

<file path="src/renderer/helpers/sidebar-renderer.ts">
import { Project, Folder, Request } from '../../shared/types';
import { methodColors } from './request-builder';

export interface SidebarCallbacks {
  onNewFolder: () => void;
  onNewRequest: () => void;
  onAddRequestToFolder: (folderId: string) => void;
  onAddSubfolder: (parentId: string) => void;
  onDeleteFolder: (folderId: string) => void;
  onDeleteRequest: (requestId: string) => void;
  onLoadRequest: (request: Request) => void;
}

export function renderSidebar(
  container: HTMLDivElement,
  project: Project | null,
  callbacks: SidebarCallbacks,
  activeRequestId?: string
): void {
  container.innerHTML = '';
  
  if (!project) {
    container.innerHTML = '<div class="text-gray-400 text-center py-4 text-sm">Select a project to view its contents</div>';
    return;
  }
  
  // Add New Folder Button
  const newFolderBtn = document.createElement('button');
  newFolderBtn.className = "w-full px-3 py-2 mb-4 text-sm overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer relative bg-[rgba(17,24,39,0.3)] backdrop-blur-xs shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)] transition-all duration-500 ease-in-out hover:backdrop-blur-md hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)] before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent before:skew-x-[-25deg] before:transition-all before:duration-500 before:ease-in-out hover:before:left-[150%] active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)] active:duration-10";
  newFolderBtn.textContent = '+ New Folder';
  newFolderBtn.onclick = callbacks.onNewFolder;
  container.appendChild(newFolderBtn);
  
  // Add New Request Button
  const newRequestBtn = document.createElement('button');
  newRequestBtn.className = "w-full px-3 py-2 mb-4 text-sm overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer relative bg-[rgba(17,24,39,0.3)] backdrop-blur-xs shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)] transition-all duration-500 ease-in-out hover:backdrop-blur-md hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)] before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent before:skew-x-[-25deg] before:transition-all before:duration-500 before:ease-in-out hover:before:left-[150%] active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)] active:duration-10";
  newRequestBtn.textContent = '+ New Request';
  newRequestBtn.onclick = callbacks.onNewRequest;
  container.appendChild(newRequestBtn);
  
  // Render folders
  project.folders.forEach(folder => {
    renderFolder(folder, container, 0, callbacks, activeRequestId);
  });
  
  // Render root requests
  project.requests.forEach(request => {
    renderRequest(request, container, 0, callbacks, activeRequestId);
  });
}

function renderFolder(
  folder: Folder,
  container: HTMLElement,
  depth: number,
  callbacks: SidebarCallbacks,
  activeRequestId?: string
): void {
  const folderDiv = document.createElement('div');
  folderDiv.className = 'mb-2';
  folderDiv.style.marginLeft = `${depth * 20}px`;
  
  const folderHeader = document.createElement('div');
  folderHeader.className = 'flex items-center justify-between bg-gray-800 p-2 rounded cursor-pointer hover:bg-gray-750';
  
  const folderName = document.createElement('div');
  folderName.className = 'flex items-center gap-2';
  folderName.innerHTML = `<span><svg class="w-5 h-5 inline-block mb-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M3 8.2C3 7.07989 3 6.51984 3.21799 6.09202C3.40973 5.71569 3.71569 5.40973 4.09202 5.21799C4.51984 5 5.0799 5 6.2 5H9.67452C10.1637 5 10.4083 5 10.6385 5.05526C10.8425 5.10425 11.0376 5.18506 11.2166 5.29472C11.4184 5.4184 11.5914 5.59135 11.9373 5.93726L12.0627 6.06274C12.4086 6.40865 12.5816 6.5816 12.7834 6.70528C12.9624 6.81494 13.1575 6.89575 13.3615 6.94474C13.5917 7 13.8363 7 14.3255 7H17.8C18.9201 7 19.4802 7 19.908 7.21799C20.2843 7.40973 20.5903 7.71569 20.782 8.09202C21 8.51984 21 9.0799 21 10.2V15.8C21 16.9201 21 17.4802 20.782 17.908C20.5903 18.2843 20.2843 18.5903 19.908 18.782C19.4802 19 18.9201 19 17.8 19H6.2C5.07989 19 4.51984 19 4.09202 18.782C3.71569 18.5903 3.40973 18.2843 3.21799 17.908C3 17.4802 3 16.9201 3 15.8V8.2Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg></span><span class="text-sm">${folder.name}</span>`;
  
  const folderActions = document.createElement('div');
  folderActions.className = 'flex gap-1';
  
  const addRequestBtn = document.createElement('button');
  addRequestBtn.textContent = '+';
  addRequestBtn.className = `px-2 py-1 text-xs overflow-hidden border border-gray-400 rounded-md cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10`;
  addRequestBtn.onclick = (e) => {
    e.stopPropagation();
    callbacks.onAddRequestToFolder(folder.id);
  };
  
  const addSubfolderBtn = document.createElement('button');
  addSubfolderBtn.innerHTML = `<svg class="w-4 h-4 inline-block mb-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#CCCCCC" stroke-width="0.672"></g><g id="SVGRepo_iconCarrier"> <path d="M9 13H15M12 10V16M12.0627 6.06274L11.9373 5.93726C11.5914 5.59135 11.4184 5.4184 11.2166 5.29472C11.0376 5.18506 10.8425 5.10425 10.6385 5.05526C10.4083 5 10.1637 5 9.67452 5H6.2C5.0799 5 4.51984 5 4.09202 5.21799C3.71569 5.40973 3.40973 5.71569 3.21799 6.09202C3 6.51984 3 7.07989 3 8.2V15.8C3 16.9201 3 17.4802 3.21799 17.908C3.40973 18.2843 3.71569 18.5903 4.09202 18.782C4.51984 19 5.07989 19 6.2 19H17.8C18.9201 19 19.4802 19 19.908 18.782C20.2843 18.5903 20.5903 18.2843 20.782 17.908C21 17.4802 21 16.9201 21 15.8V10.2C21 9.0799 21 8.51984 20.782 8.09202C20.5903 7.71569 20.2843 7.40973 19.908 7.21799C19.4802 7 18.9201 7 17.8 7H14.3255C13.8363 7 13.5917 7 13.3615 6.94474C13.1575 6.89575 12.9624 6.81494 12.7834 6.70528C12.5816 6.5816 12.4086 6.40865 12.0627 6.06274Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>`;
  addSubfolderBtn.className = `px-2 py-1 overflow-hidden border border-gray-400 rounded-md cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10`;
  addSubfolderBtn.onclick = (e) => {
    e.stopPropagation();
    callbacks.onAddSubfolder(folder.id);
  };
  
  const deleteFolderBtn = document.createElement('button');
  deleteFolderBtn.textContent = 'Ã—';
  deleteFolderBtn.className = `px-2 py-1 text-xs overflow-hidden border border-gray-400 rounded-md cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10`;
  deleteFolderBtn.onclick = (e) => {
    e.stopPropagation();
    callbacks.onDeleteFolder(folder.id);
  };
  
  folderActions.appendChild(addRequestBtn);
  folderActions.appendChild(addSubfolderBtn);
  folderActions.appendChild(deleteFolderBtn);
  
  folderHeader.appendChild(folderName);
  folderHeader.appendChild(folderActions);
  folderDiv.appendChild(folderHeader);
  
  const folderContent = document.createElement('div');
  folderContent.className = 'ml-4 mt-1';
  
  folder.subfolders.forEach(subfolder => {
    renderFolder(subfolder, folderContent, depth + 1, callbacks, activeRequestId);
  });
  
  folder.requests.forEach(request => {
    renderRequest(request, folderContent, depth + 1, callbacks, activeRequestId);
  });
  
  folderDiv.appendChild(folderContent);
  container.appendChild(folderDiv);
}

function renderRequest(
  request: Request,
  container: HTMLElement,
  depth: number,
  callbacks: SidebarCallbacks,
  activeRequestId?: string
): void {
  const isActive = activeRequestId === request.id;
  
  const requestDiv = document.createElement('div');
  requestDiv.className = `p-2 rounded mb-1 cursor-pointer flex items-center justify-between ${
    isActive ? 'bg-gray-700 border border-gray-500' : 'bg-gray-800 hover:bg-gray-750'
  }`;
  requestDiv.style.marginLeft = `${depth * 20}px`;
  
  const methodColor = methodColors[request.method] || 'text-gray-400';
  
  const requestInfo = document.createElement('div');
  requestInfo.className = 'flex items-center gap-2 flex-1';
  requestInfo.innerHTML = `
    <span class="font-semibold ${methodColor} text-xs">${request.method}</span>
    <span class="text-sm ${isActive ? 'text-white font-semibold' : 'text-gray-300'}">${request.name}</span>
  `;
  
  const deleteBtn = document.createElement('button');
  deleteBtn.textContent = 'Ã—';
  deleteBtn.className = `px-2 py-1 text-xs overflow-hidden border border-gray-400 rounded-md text-lg cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10`;
  deleteBtn.onclick = (e) => {
    e.stopPropagation();
    callbacks.onDeleteRequest(request.id);
  };
  
  requestDiv.onclick = () => {
    callbacks.onLoadRequest(request);
  };
  
  requestDiv.appendChild(requestInfo);
  requestDiv.appendChild(deleteBtn);
  container.appendChild(requestDiv);
}
</file>

<file path="tsconfig.json">
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "commonjs",
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "moduleResolution": "node",
    "resolveJsonModule": true
  },
  "include": ["src/main/**/*", "src/preload/**/*", "src/shared/**/*"],
  "exclude": ["node_modules", "src/renderer/**/*"]
}
</file>

<file path="src/renderer/helpers/key-value-renderer.ts">
import { KeyValue } from '../../shared/types';

export function createKeyValueRow(
  key: string = '',
  value: string = '',
  enabled: boolean = true,
  onDelete: () => void,
  onChange?: () => void,
  sensitive: boolean = false,
  showSensitiveToggle: boolean = false
): HTMLDivElement {
  const row = document.createElement('div');
  row.className = 'flex gap-2 items-center mb-2';
  
  const checkbox = document.createElement('input');
  checkbox.type = 'checkbox';
  checkbox.checked = enabled;
  checkbox.className = 'w-5 h-5 rounded border border-gray-700 accent-[rgb(7,14,29)] cursor-pointer bg-[rgba(7,14,29,1.0)]';
  if (onChange) {
    checkbox.addEventListener('change', onChange);
  }
  
  const keyInput = document.createElement('input');
  keyInput.type = 'text';
  keyInput.value = key;
  keyInput.placeholder = 'Key';
  keyInput.className = 'flex-1 bg-[rgba(7,14,29,0.7)] text-white p-2 rounded border border-gray-700';
  keyInput.dataset.keyInput = 'true';
  if (onChange) {
    keyInput.addEventListener('input', onChange);
  }
  
  const valueInput = document.createElement('input');
  valueInput.type = sensitive ? 'password' : 'text';
  valueInput.value = value;
  valueInput.placeholder = 'Value';
  valueInput.className = 'flex-1 bg-[rgba(7,14,29,0.7)] text-white p-2 rounded border border-gray-700';
  valueInput.dataset.valueInput = 'true';
  if (onChange) {
    valueInput.addEventListener('input', onChange);
  }
  
  row.appendChild(checkbox);
  row.appendChild(keyInput);
  row.appendChild(valueInput);
  
  // Add sensitive toggle if needed
  if (showSensitiveToggle) {
    const sensitiveBtn = document.createElement('button');
    sensitiveBtn.type = 'button';
    
    // Locked state: same effects but brighter background
    const lockedClass = `px-3 py-3 text-xl rounded-md overflow-hidden relative border border-gray-400 cursor-pointer flex items-center justify-center
                bg-[rgba(17,24,39,0.7)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10`;
    
    // Unlocked state: normal background
    const unlockedClass = `px-3 py-3 text-xl rounded-md overflow-hidden relative border border-gray-400 cursor-pointer flex items-center justify-center
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10`;
    
    sensitiveBtn.className = sensitive ? lockedClass : unlockedClass;
    sensitiveBtn.dataset.sensitiveBtn = 'true';
    
    sensitiveBtn.innerHTML = `<svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M12 14.5V16.5M7 10.0288C7.47142 10 8.05259 10 8.8 10H15.2C15.9474 10 16.5286 10 17 10.0288M7 10.0288C6.41168 10.0647 5.99429 10.1455 5.63803 10.327C5.07354 10.6146 4.6146 11.0735 4.32698 11.638C4 12.2798 4 13.1198 4 14.8V16.2C4 17.8802 4 18.7202 4.32698 19.362C4.6146 19.9265 5.07354 20.3854 5.63803 20.673C6.27976 21 7.11984 21 8.8 21H15.2C16.8802 21 17.7202 21 18.362 20.673C18.9265 20.3854 19.3854 19.9265 19.673 19.362C20 18.7202 20 17.8802 20 16.2V14.8C20 13.1198 20 12.2798 19.673 11.638C19.3854 11.0735 18.9265 10.6146 18.362 10.327C18.0057 10.1455 17.5883 10.0647 17 10.0288M7 10.0288V8C7 5.23858 9.23858 3 12 3C14.7614 3 17 5.23858 17 8V10.0288" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>`;
    sensitiveBtn.title = 'Mark as sensitive (encrypted storage)';
    
    let isSensitive = sensitive;
    sensitiveBtn.onclick = () => {
      isSensitive = !isSensitive;
      sensitiveBtn.className = isSensitive ? lockedClass : unlockedClass;
      valueInput.type = isSensitive ? 'password' : 'text';
      sensitiveBtn.dataset.isSensitive = isSensitive.toString();
      if (onChange) onChange();
    };
    sensitiveBtn.dataset.isSensitive = sensitive.toString();
    
    row.appendChild(sensitiveBtn);
  }
  
  const deleteBtn = document.createElement('button');
  deleteBtn.innerHTML = `<svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g id="Menu / Close_SM"> <path id="Vector" d="M16 16L12 12M12 12L8 8M12 12L16 8M12 12L8 16" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g> </g></svg>`;
  deleteBtn.className = "px-2 py-2 text-xl font-bold overflow-hidden border border-gray-400 rounded-md cursor-pointer flex items-center justify-center bg-[rgba(17,24,39,0.3)] backdrop-blur-xs shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)] transition-all duration-500 ease-in-out hover:backdrop-blur-md hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)] before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent before:skew-x-[-25deg] before:transition-all before:duration-500 before:ease-in-out hover:before:left-[150%] active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)] active:duration-10";
  deleteBtn.onclick = onDelete;
  
  row.appendChild(deleteBtn);
  
  return row;
}

export function syncArrayFromDOM(container: HTMLDivElement, items: KeyValue[]): void {
  const rows = container.querySelectorAll('.flex');
  
  // Clear the array and rebuild from DOM
  items.length = 0;
  
  rows.forEach((row) => {
    const checkbox = row.querySelector('input[type="checkbox"]') as HTMLInputElement;
    const keyInput = row.querySelector('[data-key-input]') as HTMLInputElement;
    const valueInput = row.querySelector('[data-value-input]') as HTMLInputElement;
    const sensitiveBtn = row.querySelector('[data-sensitive-btn]') as HTMLButtonElement;
    
    if (checkbox && keyInput && valueInput) {
      items.push({
        key: keyInput.value,
        value: valueInput.value,
        enabled: checkbox.checked,
        sensitive: sensitiveBtn ? sensitiveBtn.dataset.isSensitive === 'true' : false
      });
    }
  });
}

export function renderKeyValueList(
  container: HTMLDivElement,
  items: KeyValue[],
  onUpdate: () => void,
  showSensitiveToggle: boolean = false
): void {
  
  container.innerHTML = '';
  items.forEach((item, index) => {
    const row = createKeyValueRow(
      item.key, 
      item.value, 
      item.enabled, 
      () => {
        items.splice(index, 1);
        renderKeyValueList(container, items, onUpdate, showSensitiveToggle);
        onUpdate();
      }, 
      onUpdate,
      item.sensitive || false,
      showSensitiveToggle
    );
    container.appendChild(row);
  });
}

export function addKeyValue(
  items: KeyValue[],
  container: HTMLDivElement,
  onUpdate: () => void,
  showSensitiveToggle: boolean = false
): void {
  // Sync current DOM values back to array FIRST
  syncArrayFromDOM(container, items);
  
  // Then add new empty item
  items.push({ key: '', value: '', enabled: true });
  
  // Re-render
  renderKeyValueList(container, items, onUpdate, showSensitiveToggle);
}
</file>

<file path="src/styles/input.css">
@import 'highlight.js/styles/atom-one-dark.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer components {
  #result {
    overflow: auto !important;
  }
  
  #result pre {
    margin: 0 !important;
    background: transparent !important;
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
  }
  
  #result code {
    display: block !important;
    padding: 1rem !important;
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
  }

  /* Custom checkbox styles */
  input[type="checkbox"] {
    appearance: none;
    -webkit-appearance: none;
    background-color: rgb(7, 14, 29);
    border: 1px solid rgb(55, 65, 81);
    cursor: pointer;
  }
  
  input[type="checkbox"]:checked {
    background-color: rgb(7, 14, 29);
    border-color: rgb(255, 255, 255);
  }
  
  input[type="checkbox"]:checked::before {
    content: "âœ“";
    display: block;
    text-align: center;
    color: white;
    font-size: 14px;
    line-height: 1.25rem;
  }
}
</file>

<file path="src/main/ipc/request-handler.ts">
import { exec } from 'child_process';
import { promisify } from 'util';
import * as https from 'https';
import * as http from 'http';
import { URL } from 'url';
import { Request, HttpResponse, KeyValue, NetworkInfo } from '../../shared/types';

const execAsync = promisify(exec);

export class RequestHandler {
  private buildCurlCommand(request: Request): string {
    let command = 'curl -i -s';
    
    // Add method
    if (request.method !== 'GET') {
      command += ` -X ${request.method}`;
    }
    
    // Add headers
    if (request.headers && request.headers.length > 0) {
      request.headers
        .filter(h => h.enabled && h.key && h.value)
        .forEach(header => {
          command += ` -H "${header.key}: ${this.escapeValue(header.value)}"`;
        });
    }
    
    // Add auth
    if (request.auth && request.auth.type !== 'none') {
      switch (request.auth.type) {
        case 'basic':
          if (request.auth.basic && request.auth.basic.username && request.auth.basic.password) {
            command += ` -u "${this.escapeValue(request.auth.basic.username)}:${this.escapeValue(request.auth.basic.password)}"`;
          }
          break;
        case 'bearer':
          if (request.auth.bearer && request.auth.bearer.token) {
            command += ` -H "Authorization: Bearer ${this.escapeValue(request.auth.bearer.token)}"`;
          }
          break;
        case 'api-key':
          if (request.auth.apiKey && request.auth.apiKey.key && request.auth.apiKey.value) {
            if (request.auth.apiKey.addTo === 'header') {
              command += ` -H "${this.escapeValue(request.auth.apiKey.key)}: ${this.escapeValue(request.auth.apiKey.value)}"`;
            }
          }
          break;
      }
    }
    
    // Build URL with query params
    let url = request.url;
    const enabledParams = request.queryParams?.filter(p => p.enabled && p.key) || [];
    if (enabledParams.length > 0) {
      const queryString = enabledParams
        .map(p => `${encodeURIComponent(p.key)}=${encodeURIComponent(p.value || '')}`)
        .join('&');
      url += (url.includes('?') ? '&' : '?') + queryString;
    }
    
    // Add API key to query if needed
    if (request.auth?.type === 'api-key' && 
        request.auth.apiKey?.addTo === 'query' && 
        request.auth.apiKey.key && 
        request.auth.apiKey.value) {
      const separator = url.includes('?') ? '&' : '?';
      url += `${separator}${encodeURIComponent(request.auth.apiKey.key)}=${encodeURIComponent(request.auth.apiKey.value)}`;
    }
    
    // Add body
    if (request.body && request.body.type !== 'none') {
      switch (request.body.type) {
        case 'json':
          if (request.body.json) {
            const jsonStr = typeof request.body.json === 'string' 
              ? request.body.json 
              : JSON.stringify(request.body.json);
            if (jsonStr.trim()) {
              command += ` -H "Content-Type: application/json"`;
              command += ` -d '${this.escapeValue(jsonStr)}'`;
            }
          }
          break;
        case 'raw':
          if (request.body.raw && request.body.raw.trim()) {
            command += ` -d '${this.escapeValue(request.body.raw)}'`;
          }
          break;
        case 'x-www-form-urlencoded':
          if (request.body.formData && request.body.formData.length > 0) {
            command += ` -H "Content-Type: application/x-www-form-urlencoded"`;
            const formStr = request.body.formData
              .filter(f => f.enabled && f.key)
              .map(f => `${encodeURIComponent(f.key)}=${encodeURIComponent(f.value || '')}`)
              .join('&');
            if (formStr) {
              command += ` -d '${formStr}'`;
            }
          }
          break;
        case 'form-data':
          if (request.body.formData && request.body.formData.length > 0) {
            request.body.formData
              .filter(f => f.enabled && f.key)
              .forEach(field => {
                command += ` -F "${this.escapeValue(field.key)}=${this.escapeValue(field.value || '')}"`;
              });
          }
          break;
      }
    }
    
    // Add timing, size info, and connection details
    command += ` -w "\\n__CURL_TIME__%{time_total}\\n__CURL_SIZE__%{size_download}\\n__CURL_HTTP_CODE__%{http_code}\\n__CURL_HTTP_VERSION__%{http_version}\\n__CURL_LOCAL_IP__%{local_ip}\\n__CURL_LOCAL_PORT__%{local_port}\\n__CURL_REMOTE_IP__%{remote_ip}\\n__CURL_REMOTE_PORT__%{remote_port}\\n__CURL_SSL_VERSION__%{ssl_version}"`;
    
    // Show errors but don't fail
    command += ` --fail-with-body`;
    
    // Add verbose flag to capture SSL/TLS info
    command += ` -v`;
    
    command += ` "${url}"`;
    
    return command;
  }
  
  private escapeValue(value: string): string {
    return value.replace(/'/g, "'\\''");
  }
  
  private getStatusText(code: number): string {
    const statusTexts: Record<number, string> = {
      100: 'Continue',
      101: 'Switching Protocols',
      200: 'OK',
      201: 'Created',
      202: 'Accepted',
      203: 'Non-Authoritative Information',
      204: 'No Content',
      205: 'Reset Content',
      206: 'Partial Content',
      300: 'Multiple Choices',
      301: 'Moved Permanently',
      302: 'Found',
      303: 'See Other',
      304: 'Not Modified',
      307: 'Temporary Redirect',
      308: 'Permanent Redirect',
      400: 'Bad Request',
      401: 'Unauthorized',
      402: 'Payment Required',
      403: 'Forbidden',
      404: 'Not Found',
      405: 'Method Not Allowed',
      406: 'Not Acceptable',
      407: 'Proxy Authentication Required',
      408: 'Request Timeout',
      409: 'Conflict',
      410: 'Gone',
      411: 'Length Required',
      412: 'Precondition Failed',
      413: 'Payload Too Large',
      414: 'URI Too Long',
      415: 'Unsupported Media Type',
      416: 'Range Not Satisfiable',
      417: 'Expectation Failed',
      418: "I'm a teapot",
      422: 'Unprocessable Entity',
      425: 'Too Early',
      426: 'Upgrade Required',
      428: 'Precondition Required',
      429: 'Too Many Requests',
      431: 'Request Header Fields Too Large',
      451: 'Unavailable For Legal Reasons',
      500: 'Internal Server Error',
      501: 'Not Implemented',
      502: 'Bad Gateway',
      503: 'Service Unavailable',
      504: 'Gateway Timeout',
      505: 'HTTP Version Not Supported',
      511: 'Network Authentication Required'
    };
    return statusTexts[code] || 'Unknown';
  }
  
  private parseHeaders(headerText: string): Record<string, string> {
    const headers: Record<string, string> = {};
    const lines = headerText.split('\n');
    
    for (const line of lines) {
      const match = line.match(/^([^:]+):\s*(.+)$/);
      if (match) {
        headers[match[1].toLowerCase()] = match[2].trim();
      }
    }
    
    return headers;
  }
  
  private parseNetworkInfo(stderr: string, stdout: string): NetworkInfo {
    const networkInfo: NetworkInfo = {};
    
    // Extract HTTP version from curl write-out
    const httpVersionMatch = stdout.match(/__CURL_HTTP_VERSION__([^\n]+)/);
    if (httpVersionMatch) {
      const version = httpVersionMatch[1].trim();
      if (version === '2') {
        networkInfo.httpVersion = 'HTTP/2';
      } else if (version === '1.1') {
        networkInfo.httpVersion = 'HTTP/1.1';
      } else if (version === '1.0') {
        networkInfo.httpVersion = 'HTTP/1.0';
      } else if (version === '3') {
        networkInfo.httpVersion = 'HTTP/3';
      } else {
        networkInfo.httpVersion = `HTTP/${version}`;
      }
    }
    
    // Extract local address
    const localIpMatch = stdout.match(/__CURL_LOCAL_IP__([^\n]+)/);
    const localPortMatch = stdout.match(/__CURL_LOCAL_PORT__([^\n]+)/);
    if (localIpMatch && localPortMatch) {
      networkInfo.localAddress = `${localIpMatch[1].trim()}:${localPortMatch[1].trim()}`;
    }
    
    // Extract remote address
    const remoteIpMatch = stdout.match(/__CURL_REMOTE_IP__([^\n]+)/);
    const remotePortMatch = stdout.match(/__CURL_REMOTE_PORT__([^\n]+)/);
    if (remoteIpMatch && remotePortMatch) {
      networkInfo.remoteAddress = `${remoteIpMatch[1].trim()}:${remotePortMatch[1].trim()}`;
    }
    
    // Try to get SSL version from curl write-out
    const sslVersionMatch = stdout.match(/__CURL_SSL_VERSION__([^\n]+)/);
    if (sslVersionMatch && sslVersionMatch[1].trim()) {
      const sslVersion = sslVersionMatch[1].trim();
      if (sslVersion && sslVersion !== '' && sslVersion !== '0') {
        networkInfo.tlsProtocol = sslVersion;
      }
    }
    
    // Parse SSL/TLS information from verbose output (stderr)
    if (!networkInfo.tlsProtocol) {
      const tlsPatterns = [
        /SSL connection using (TLSv[\d.]+)\s*\/?\s*([^\r\n]*)/i,
        /SSL connection using (TLSv[\d.]+)/i,
        /schannel: (TLSv[\d.]+)/i,
        /\*\s+(TLSv[\d.]+)/i,
      ];
      
      for (const pattern of tlsPatterns) {
        const match = stderr.match(pattern);
        if (match) {
          networkInfo.tlsProtocol = match[1].trim();
          if (match[2] && match[2].trim()) {
            networkInfo.cipherName = match[2].trim();
          }
          break;
        }
      }
    }
    
    // Cipher patterns
    if (!networkInfo.cipherName) {
      const cipherPatterns = [
        /Cipher is ([^\r\n]+)/i,
        /cipher suite:\s*([^\r\n]+)/i,
        /((?:ECDHE|DHE|RSA)[-_](?:RSA|ECDSA)[-_](?:AES|CHACHA20)[-_][\w\-_]+)/i,
        /(TLS_[\w_]+)/,
      ];
      
      for (const pattern of cipherPatterns) {
        const match = stderr.match(pattern);
        if (match) {
          networkInfo.cipherName = match[1].trim();
          break;
        }
      }
    }
    
    // Certificate CN
    const certCNPatterns = [
      /\*\s+Subject:\s*CN\s*=\s*([^,\r\n]+)/i,
      /subject:\s*CN\s*=\s*([^,\r\n]+)/i,
    ];
    
    for (const pattern of certCNPatterns) {
      const match = stderr.match(pattern);
      if (match) {
        networkInfo.certificateCN = match[1].trim();
        break;
      }
    }
    
    // Issuer CN
    const issuerCNPatterns = [
      /\*\s+Issuer:.*CN\s*=\s*([^,\r\n]+)/i,
      /issuer:.*CN\s*=\s*([^,\r\n]+)/i,
    ];
    
    for (const pattern of issuerCNPatterns) {
      const match = stderr.match(pattern);
      if (match) {
        networkInfo.issuerCN = match[1].trim();
        break;
      }
    }
    
    // Valid until
    const expireDatePatterns = [
      /\*\s+Expire Date:\s*([^\r\n]+)/i,
      /expire date:\s*([^\r\n]+)/i,
      /Not After\s*:\s*([^\r\n]+)/i,
    ];
    
    for (const pattern of expireDatePatterns) {
      const match = stderr.match(pattern);
      if (match) {
        networkInfo.validUntil = match[1].trim();
        break;
      }
    }
    
    return networkInfo;
  }
  
  private async executeWithNodeHttps(request: Request): Promise<HttpResponse> {
    const startTime = Date.now();
    
    return new Promise((resolve, reject) => {
      try {
        // Build URL with query params first
        let fullUrl = request.url;
        const enabledParams = request.queryParams?.filter(p => p.enabled && p.key) || [];
        if (enabledParams.length > 0) {
          const queryString = enabledParams
            .map(p => `${encodeURIComponent(p.key)}=${encodeURIComponent(p.value || '')}`)
            .join('&');
          fullUrl += (fullUrl.includes('?') ? '&' : '?') + queryString;
        }
        
        // Add API key to query if needed
        if (request.auth?.type === 'api-key' && 
            request.auth.apiKey?.addTo === 'query' && 
            request.auth.apiKey.key && 
            request.auth.apiKey.value) {
          const separator = fullUrl.includes('?') ? '&' : '?';
          fullUrl += `${separator}${encodeURIComponent(request.auth.apiKey.key)}=${encodeURIComponent(request.auth.apiKey.value)}`;
        }
        
        const urlObj = new URL(fullUrl);
        const isHttps = urlObj.protocol === 'https:';
        const client = isHttps ? https : http;
        
        // Build request options
        const options: any = {
          hostname: urlObj.hostname,
          port: urlObj.port || (isHttps ? 443 : 80),
          path: urlObj.pathname + urlObj.search,
          method: request.method,
          headers: {},
          rejectUnauthorized: false,
        };
        
        // Add headers
        if (request.headers && request.headers.length > 0) {
          request.headers
            .filter(h => h.enabled && h.key && h.value)
            .forEach(header => {
              options.headers[header.key] = header.value;
            });
        }
        
        // Add auth
        if (request.auth && request.auth.type !== 'none') {
          switch (request.auth.type) {
            case 'basic':
              if (request.auth.basic) {
                const auth = Buffer.from(`${request.auth.basic.username}:${request.auth.basic.password}`).toString('base64');
                options.headers['Authorization'] = `Basic ${auth}`;
              }
              break;
            case 'bearer':
              if (request.auth.bearer) {
                options.headers['Authorization'] = `Bearer ${request.auth.bearer.token}`;
              }
              break;
            case 'api-key':
              if (request.auth.apiKey) {
                if (request.auth.apiKey.addTo === 'header') {
                  options.headers[request.auth.apiKey.key] = request.auth.apiKey.value;
                }
              }
              break;
          }
        }
        
        let networkInfo: NetworkInfo = {};
        let requestBody = '';
        
        // Prepare body
        if (request.body && request.body.type !== 'none') {
          switch (request.body.type) {
            case 'json':
              if (request.body.json) {
                requestBody = typeof request.body.json === 'string' 
                  ? request.body.json 
                  : JSON.stringify(request.body.json);
                options.headers['Content-Type'] = 'application/json';
                options.headers['Content-Length'] = Buffer.byteLength(requestBody);
              }
              break;
            case 'raw':
              if (request.body.raw) {
                requestBody = request.body.raw;
                options.headers['Content-Length'] = Buffer.byteLength(requestBody);
              }
              break;
            case 'x-www-form-urlencoded':
              if (request.body.formData && request.body.formData.length > 0) {
                requestBody = request.body.formData
                  .filter(f => f.enabled && f.key)
                  .map(f => `${encodeURIComponent(f.key)}=${encodeURIComponent(f.value || '')}`)
                  .join('&');
                options.headers['Content-Type'] = 'application/x-www-form-urlencoded';
                options.headers['Content-Length'] = Buffer.byteLength(requestBody);
              }
              break;
          }
        }
        
        const req = client.request(options, (res: any) => {
          const chunks: Buffer[] = [];
          
          // Capture TLS information for HTTPS
          if (isHttps && res.socket && (res.socket as any).getPeerCertificate) {
            const socket = res.socket as any;
            const tlsSocket = socket;
            
            // Get TLS version
            if (tlsSocket.getProtocol) {
              networkInfo.tlsProtocol = tlsSocket.getProtocol();
            }
            
            // Get cipher
            if (tlsSocket.getCipher) {
              const cipher = tlsSocket.getCipher();
              if (cipher && cipher.name) {
                networkInfo.cipherName = cipher.name;
              }
            }
            
            // Get certificate info
            try {
              const cert = tlsSocket.getPeerCertificate();
              if (cert && cert.subject) {
                networkInfo.certificateCN = cert.subject.CN;
              }
              if (cert && cert.issuer) {
                networkInfo.issuerCN = cert.issuer.CN;
              }
              if (cert && cert.valid_to) {
                networkInfo.validUntil = cert.valid_to;
              }
            } catch (err) {
              console.error('Error getting certificate:', err);
            }
            
            // Get local and remote addresses
            if (socket.localAddress && socket.localPort) {
              networkInfo.localAddress = `${socket.localAddress}:${socket.localPort}`;
            }
            if (socket.remoteAddress && socket.remotePort) {
              networkInfo.remoteAddress = `${socket.remoteAddress}:${socket.remotePort}`;
            }
          }
          
          // Get HTTP version
          networkInfo.httpVersion = `HTTP/${res.httpVersion}`;
          
          res.on('data', (chunk: Buffer) => {
            chunks.push(chunk);
          });
          
          res.on('end', () => {
            const body = Buffer.concat(chunks).toString('utf8');
            const time = Date.now() - startTime;
            const size = Buffer.concat(chunks).length;
            
            // Parse response headers
            const headers: Record<string, string> = {};
            Object.keys(res.headers).forEach(key => {
              headers[key] = res.headers[key];
            });
            
            const statusCode = res.statusCode || 0;
            const statusText = res.statusMessage || this.getStatusText(statusCode);
            
            resolve({
              status: statusCode,
              statusText: statusText,
              headers,
              body,
              time,
              size,
              timestamp: Date.now(),
              networkInfo
            });
          });
        });
        
        req.on('error', (error: Error) => {
          reject(error);
        });
        
        if (requestBody) {
          req.write(requestBody);
        }
        
        req.end();
      } catch (error) {
        reject(error);
      }
    });
  }
  
  async execute(request: Request): Promise<HttpResponse> {
    const startTime = Date.now();
    
    // For all requests, use Node.js native client for better body parsing
    try {
      const url = new URL(request.url);
      
      return await this.executeWithNodeHttps(request);
    } catch (urlError) {
      
    }
    
    // Fall back to curl only if URL parsing fails
    try {
      const command = this.buildCurlCommand(request);
      
      
      let stdout = '';
      let stderr = '';
      
      try {
        const result = await execAsync(command, { maxBuffer: 10 * 1024 * 1024 });
        stdout = result.stdout;
        stderr = result.stderr;
      } catch (error: any) {
        stdout = error.stdout || '';
        stderr = error.stderr || '';
        
        if (!stdout) {
          if (stderr.includes('Could not resolve host')) {
            throw new Error('Could not resolve host. Check the URL.');
          } else if (stderr.includes('Failed to connect')) {
            throw new Error('Connection failed. Is the server running?');
          } else if (stderr.includes('Connection refused')) {
            throw new Error('Connection refused. Is the server running on this port?');
          } else if (stderr.includes('Timeout')) {
            throw new Error('Request timed out.');
          } else {
            throw new Error(stderr || error.message || 'Request failed');
          }
        }
      }
      
      if (!stdout) {
        throw new Error('No response received from server');
      }
      
      const networkInfo = this.parseNetworkInfo(stderr, stdout);
      
      // Remove curl metadata first
      let cleanedOutput = stdout;
      cleanedOutput = cleanedOutput.replace(/__CURL_TIME__[0-9.]+\n?/g, '');
      cleanedOutput = cleanedOutput.replace(/__CURL_SIZE__[0-9]+\n?/g, '');
      cleanedOutput = cleanedOutput.replace(/__CURL_HTTP_CODE__[0-9]+\n?/g, '');
      cleanedOutput = cleanedOutput.replace(/__CURL_HTTP_VERSION__[^\n]+\n?/g, '');
      cleanedOutput = cleanedOutput.replace(/__CURL_LOCAL_IP__[^\n]+\n?/g, '');
      cleanedOutput = cleanedOutput.replace(/__CURL_LOCAL_PORT__[^\n]+\n?/g, '');
      cleanedOutput = cleanedOutput.replace(/__CURL_REMOTE_IP__[^\n]+\n?/g, '');
      cleanedOutput = cleanedOutput.replace(/__CURL_REMOTE_PORT__[^\n]+\n?/g, '');
      cleanedOutput = cleanedOutput.replace(/__CURL_SSL_VERSION__[^\n]+\n?/g, '');
      
      // Find the last HTTP status line (in case of redirects)
      const lines = cleanedOutput.split('\n');
      let lastStatusIndex = -1;
      for (let i = 0; i < lines.length; i++) {
        if (lines[i].startsWith('HTTP/')) {
          lastStatusIndex = i;
        }
      }
      
      if (lastStatusIndex === -1) {
        throw new Error('No HTTP status line found in response');
      }
      
      // Find where headers end (first empty line after status)
      let headerEndIndex = lastStatusIndex + 1;
      while (headerEndIndex < lines.length && lines[headerEndIndex].trim() !== '') {
        headerEndIndex++;
      }
      
      // Extract status line
      const statusLine = lines[lastStatusIndex];
      const statusMatch = statusLine.match(/HTTP\/[\d.]+ (\d+) (.+)/);
      
      const status = statusMatch ? parseInt(statusMatch[1]) : 0;
      const statusText = statusMatch ? statusMatch[2].trim() : this.getStatusText(status);
      
      // Extract headers
      const headerLines = lines.slice(lastStatusIndex + 1, headerEndIndex);
      const headerSection = headerLines.join('\n');
      const headers = this.parseHeaders(headerSection);
      
      // Extract body (everything after the empty line)
      const body = lines.slice(headerEndIndex + 1).join('\n').trim();
      
      // Get timing info from original stdout
      const timeMatch = stdout.match(/__CURL_TIME__([0-9.]+)/);
      const sizeMatch = stdout.match(/__CURL_SIZE__([0-9]+)/);
      
      const time = timeMatch ? parseFloat(timeMatch[1]) * 1000 : Date.now() - startTime;
      const size = sizeMatch ? parseInt(sizeMatch[1]) : body.length;
      
      return {
        status: status || 0,
        statusText: statusText,
        headers,
        body: body || '',
        time,
        size,
        timestamp: Date.now(),
        networkInfo
      };
    } catch (error) {
      return {
        status: 0,
        statusText: 'Error',
        headers: {},
        body: (error as Error).message,
        time: Date.now() - startTime,
        size: 0,
        timestamp: Date.now()
      };
    }
  }
}
</file>

<file path="src/preload/index.ts">
import { contextBridge, ipcRenderer } from 'electron';
import { Request, HttpResponse, Collection, Environment, HistoryEntry, Project } from '../shared/types';

contextBridge.exposeInMainWorld('electron', {

  // Toggle menu, obviously
  toggleMenu: () => ipcRenderer.send('toggle-menu'),

  // Request
  sendRequest: (request: Request): Promise<HttpResponse> => 
    ipcRenderer.invoke('request:send', request),
  
  // Collections
  saveCollection: (collection: Collection): Promise<void> => 
    ipcRenderer.invoke('collection:save', collection),
  loadCollections: (): Promise<Collection[]> => 
    ipcRenderer.invoke('collection:load'),
  deleteCollection: (id: string): Promise<void> => 
    ipcRenderer.invoke('collection:delete', id),
  
  // Projects
  saveProject: (project: Project): Promise<void> => 
    ipcRenderer.invoke('project:save', project),
  loadProjects: (): Promise<Project[]> => 
    ipcRenderer.invoke('project:load'),
  deleteProject: (id: string): Promise<void> => 
    ipcRenderer.invoke('project:delete', id),
  exportProject: (project: Project): Promise<void> => 
    ipcRenderer.invoke('project:export', project),
  importProject: (): Promise<Project | null> => 
    ipcRenderer.invoke('project:import'),
  
  // Environments
  saveEnvironment: (environment: Environment): Promise<void> => 
    ipcRenderer.invoke('environment:save', environment),
  loadEnvironments: (): Promise<Environment[]> => 
    ipcRenderer.invoke('environment:load'),
  deleteEnvironment: (id: string): Promise<void> => 
    ipcRenderer.invoke('environment:delete', id),
  setActiveEnvironment: (id: string): Promise<void> => 
    ipcRenderer.invoke('environment:setActive', id),
  
  // History
  getHistory: (limit?: number): Promise<HistoryEntry[]> => 
    ipcRenderer.invoke('history:get', limit),
  clearHistory: (): Promise<void> => 
    ipcRenderer.invoke('history:clear'),
  
  // Export/Import Request
  exportRequest: (request: Request): Promise<void> => 
    ipcRenderer.invoke('request:export', request),
  importRequest: (): Promise<Request | null> => 
    ipcRenderer.invoke('request:import'),
});
</file>

<file path="src/main/ipc/handlers.ts">
import { ipcMain, dialog } from 'electron';
import { Request, HttpResponse, Collection, Environment, HistoryEntry, Project } from '../../shared/types';
import { RequestHandler } from './request-handler';
import { CollectionStorage } from '../storage/collections';
import { EnvironmentStorage } from '../storage/environments';
import { HistoryStorage } from '../storage/history';
import { ProjectStorage } from '../storage/projects';
import { SecureProjectStorage } from '../storage/secure-projects';
import * as fs from 'fs';

const requestHandler = new RequestHandler();
const collectionStorage = new CollectionStorage();
const environmentStorage = new EnvironmentStorage();
const historyStorage = new HistoryStorage();
// const projectStorage = new ProjectStorage();
const projectStorage = new SecureProjectStorage();

export const registerHandlers = (): void => {
  // Send HTTP request
  ipcMain.handle('request:send', async (_event, request: Request): Promise<HttpResponse> => {
    const response = await requestHandler.execute(request);
    
    // Only save to history if we got a real response (not an error)
    if (response.status > 0) {
      historyStorage.add({
        id: Date.now().toString(),
        request,
        response,
        timestamp: Date.now()
      });
    }
    
    return response;
  });
  
  // Export request to JSON file
  ipcMain.handle('request:export', async (_event, request: Request): Promise<void> => {
    const { filePath } = await dialog.showSaveDialog({
      title: 'Export Request',
      defaultPath: `${request.name || 'request'}.json`,
      filters: [
        { name: 'JSON Files', extensions: ['json'] }
      ]
    });
    
    if (filePath) {
      const requestData = JSON.stringify(request, null, 2);
      fs.writeFileSync(filePath, requestData, 'utf-8');
    }
  });
  
  // Import request from JSON file
  ipcMain.handle('request:import', async (): Promise<Request | null> => {
    const { filePaths } = await dialog.showOpenDialog({
      title: 'Import Request',
      filters: [
        { name: 'JSON Files', extensions: ['json'] }
      ],
      properties: ['openFile']
    });
    
    if (filePaths && filePaths.length > 0) {
      try {
        const fileContent = fs.readFileSync(filePaths[0], 'utf-8');
        const request = JSON.parse(fileContent) as Request;
        return request;
      } catch (error) {
        console.error('Failed to parse request file:', error);
        return null;
      }
    }
    
    return null;
  });
  
  // Collection management
  ipcMain.handle('collection:save', async (_event, collection: Collection): Promise<void> => {
    collectionStorage.save(collection);
  });
  
  ipcMain.handle('collection:load', async (): Promise<Collection[]> => {
    return collectionStorage.loadAll();
  });
  
  ipcMain.handle('collection:delete', async (_event, id: string): Promise<void> => {
    collectionStorage.delete(id);
  });
  
  // Project management
  ipcMain.handle('project:save', async (_event, project: Project): Promise<void> => {
    projectStorage.save(project);
  });
  
  ipcMain.handle('project:load', async (): Promise<Project[]> => {
    return projectStorage.loadAll();
  });
  
  ipcMain.handle('project:delete', async (_event, id: string): Promise<void> => {
    projectStorage.delete(id);
  });
  
  // Export project to JSON file
  ipcMain.handle('project:export', async (_event, project: Project): Promise<void> => {
    const { filePath } = await dialog.showSaveDialog({
      title: 'Export Project',
      defaultPath: `${project.name || 'project'}.json`,
      filters: [
        { name: 'JSON Files', extensions: ['json'] }
      ]
    });
    
    if (filePath) {
      const projectData = JSON.stringify(project, null, 2);
      fs.writeFileSync(filePath, projectData, 'utf-8');
    }
  });
  
  // Import project from JSON file
  ipcMain.handle('project:import', async (): Promise<Project | null> => {
    const { filePaths } = await dialog.showOpenDialog({
      title: 'Import Project',
      filters: [
        { name: 'JSON Files', extensions: ['json'] }
      ],
      properties: ['openFile']
    });
    
    if (filePaths && filePaths.length > 0) {
      try {
        const fileContent = fs.readFileSync(filePaths[0], 'utf-8');
        const project = JSON.parse(fileContent) as Project;
        // Save imported project
        projectStorage.save(project);
        return project;
      } catch (error) {
        console.error('Failed to parse project file:', error);
        return null;
      }
    }
    
    return null;
  });
  
  // Environment management
  ipcMain.handle('environment:save', async (_event, environment: Environment): Promise<void> => {
    environmentStorage.save(environment);
  });
  
  ipcMain.handle('environment:load', async (): Promise<Environment[]> => {
    return environmentStorage.loadAll();
  });
  
  ipcMain.handle('environment:delete', async (_event, id: string): Promise<void> => {
    environmentStorage.delete(id);
  });
  
  ipcMain.handle('environment:setActive', async (_event, id: string): Promise<void> => {
    environmentStorage.setActive(id);
  });
  
  // History management
  ipcMain.handle('history:get', async (_event, limit?: number): Promise<HistoryEntry[]> => {
    return historyStorage.get(limit);
  });
  
  ipcMain.handle('history:clear', async (): Promise<void> => {
    historyStorage.clear();
  });
};
</file>

<file path="src/shared/types.ts">
export type HttpMethod = 'GET' | 'POST' | 'PUT' | 'DELETE' | 'PATCH' | 'HEAD' | 'OPTIONS';

export type AuthType = 'none' | 'basic' | 'bearer' | 'api-key' | 'oauth2';

export interface KeyValue {
  key: string;
  value: string;
  enabled: boolean;
  sensitive?: boolean;
}

export interface Auth {
  type: AuthType;
  basic?: {
    username: string;
    password: string;
  };
  bearer?: {
    token: string;
  };
  apiKey?: {
    key: string;
    value: string;
    addTo: 'header' | 'query';
  };
}

export interface SecureAuth {
  type: AuthType;
  basic?: {
    username: string;
    password: string; // base64 encrypted
  };
  bearer?: {
    token: string; // base64 encrypted
  };
  apiKey?: {
    key: string;
    value: string; // base64 encrypted
    addTo: 'header' | 'query';
  };
}

export type BodyType = 'none' | 'json' | 'form-data' | 'x-www-form-urlencoded' | 'raw' | 'binary';

export interface RequestBody {
  type: BodyType;
  raw?: string;
  json?: any;
  formData?: KeyValue[];
  binary?: string;
}

export interface Request {
  id: string;
  name: string;
  method: HttpMethod;
  url: string;
  headers: KeyValue[];
  body?: RequestBody;
  auth?: Auth;
  queryParams: KeyValue[];
  folderId?: string;
  projectId?: string;
  createdAt: number;
  updatedAt: number;
}

export interface FetchResponse {
  success: boolean;
  data?: string;
  error?: string;
  statusCode?: number;
}

export interface NetworkInfo {
  httpVersion?: string;
  localAddress?: string;
  remoteAddress?: string;
  tlsProtocol?: string;
  cipherName?: string;
  certificateCN?: string;
  issuerCN?: string;
  validUntil?: string;
}

export interface HttpResponse {
  status: number;
  statusText: string;
  headers: Record<string, string>;
  body: string;
  time: number;
  size: number;
  timestamp: number;
  networkInfo?: NetworkInfo;
}

export interface Folder {
  id: string;
  name: string;
  parentId?: string;
  projectId: string;
  requests: Request[];
  subfolders: Folder[];
  createdAt: number;
  updatedAt: number;
}

export interface Collection {
  id: string;
  name: string;
  folders: Folder[];
  requests: Request[];
  createdAt: number;
  updatedAt: number;
}

export interface Project {
  id: string;
  name: string;
  description?: string;
  baseUrl?: string;
  variables: KeyValue[];
  folders: Folder[];
  requests: Request[];
  createdAt: number;
  updatedAt: number;
}

export interface Environment {
  id: string;
  name: string;
  variables: KeyValue[];
  isActive: boolean;
}

export interface HistoryEntry {
  id: string;
  request: Request;
  response: HttpResponse;
  timestamp: number;
}

export interface IpcChannels {
  'request:send': {
    args: [Request];
    return: HttpResponse;
  };
  'collection:save': {
    args: [Collection];
    return: void;
  };
  'collection:load': {
    args: [];
    return: Collection[];
  };
  'collection:delete': {
    args: [string];
    return: void;
  };
  'project:save': {
    args: [Project];
    return: void;
  };
  'project:load': {
    args: [];
    return: Project[];
  };
  'project:delete': {
    args: [string];
    return: void;
  };
  'project:export': {
    args: [Project];
    return: void;
  };
  'project:import': {
    args: [];
    return: Project | null;
  };
  'environment:save': {
    args: [Environment];
    return: void;
  };
  'environment:load': {
    args: [];
    return: Environment[];
  };
  'environment:delete': {
    args: [string];
    return: void;
  };
  'environment:setActive': {
    args: [string];
    return: void;
  };
  'history:get': {
    args: [number?];
    return: HistoryEntry[];
  };
  'history:clear': {
    args: [];
    return: void;
  };
  'request:export': {
    args: [Request];
    return: void;
  };
  'request:import': {
    args: [];
    return: Request | null;
  };
  'fetch-url': {
    args: [string];
    return: FetchResponse;
  };
}
</file>

<file path="todo.md">
# TODO

## documentation :

- Once everything is finished, create a documentation file
- Explain in detail the GUI and how it works
- Explain in detail the functionality
- Explain in detail every file

## functionality :

- Add support for cookies
- Add default headers (autogenerated)

## UI :

- Add icons

- Add tab management (should be able to scroll left and right)

- Add to project UI needs to be updated !

## Website :

- Create a branch for the website
- Create a website for the app
- Locally create the website files in a different folder to avoid conflicts and confusion

## Localization :

- Try to add localization

## Problems :

- Remove all console logs on code cleanup
</file>

<file path="src/renderer/index.ts">
import { Request, HttpResponse, HttpMethod, KeyValue, Project, NetworkInfo } from '../shared/types';
import { TabManager } from './helpers/tab-manager';
import { replaceVariables } from './helpers/variable-replacer';
import { DisplayFormat, displayResponse } from './helpers/response-handler';
import { buildRequest, methodColors, isHttpMethod } from './helpers/request-builder';
import { renderKeyValueList, addKeyValue, syncArrayFromDOM } from './helpers/key-value-renderer';
import { deleteFolder, deleteRequest, createFolder, createRequest, addFolderToProject, addRequestToProject } from './helpers/project-manager';
import { renderSidebar, SidebarCallbacks } from './helpers/sidebar-renderer';
import { renderProjectList, ProjectCallbacks } from './helpers/project-renderer';
import { loadRequestIntoUI } from './helpers/request-loader';
import { getBreadcrumbs, renderBreadcrumbs } from './helpers/breadcrumbs';
import { getRequestContext, saveRequestToProject, updateRequestInProject } from './helpers/request-context';
import { renderFolderTree } from './helpers/folder-tree';


declare global {
  interface Window {
    electron: {
      sendRequest: (request: Request) => Promise<HttpResponse>;
      saveProject: (project: Project) => Promise<void>;
      loadProjects: () => Promise<Project[]>;
      deleteProject: (id: string) => Promise<void>;
      exportProject: (project: Project) => Promise<void>;
      importProject: () => Promise<Project | null>;
      getHistory: (limit?: number) => Promise<any[]>;
      clearHistory: () => Promise<void>;
      exportRequest: (request: Request) => Promise<void>;
      importRequest: () => Promise<Request | null>;
      toggleMenu: () => void;
    };
  }
}

type TabType = 'params' | 'headers' | 'body' | 'auth';
type ResponseTabType = 'body' | 'headers';

// State
let projects: Project[] = [];
let currentProject: Project | null = null;
let autoSaveEnabled: boolean = true;
let hasUnsavedChanges: boolean = false;
let saveDebounceTimer: number | null = null;

let currentFormat: DisplayFormat = 'raw';
let currentMethod: HttpMethod = 'GET';
let lastResponse: HttpResponse | null = null;
let currentTab: TabType = 'params';
let currentResponseTab: ResponseTabType = 'body';
let queryParams: KeyValue[] = [];
let headers: KeyValue[] = [];
let formFields: KeyValue[] = [];
let projectVariables: KeyValue[] = [];
let editingProjectId: string | null = null;
let currentFolderParentId: string | null = null;

// UI Elements - Main
const fetchButton = document.getElementById('fetch') as HTMLButtonElement;
const urlInput = document.getElementById('url') as HTMLInputElement;
const resultDiv = document.getElementById('result') as HTMLDivElement;
const formatSelect = document.getElementById('format-select') as HTMLSelectElement;
const methodButton = document.getElementById('method-button') as HTMLButtonElement;
const methodText = document.getElementById('method-text') as HTMLSpanElement;
const methodDropdown = document.getElementById('method-dropdown') as HTMLDivElement;
const statusCodeSpan = document.getElementById('status-code') as HTMLSpanElement;
const responseTimeSpan = document.getElementById('response-time') as HTMLSpanElement;
const responseSizeSpan = document.getElementById('response-size') as HTMLSpanElement;

// UI Elements - Tabs
const tabsContainer = document.getElementById('tabs-container') as HTMLDivElement;
const newTabBtn = document.getElementById('new-tab') as HTMLButtonElement;

const paramsTab = document.getElementById('params-tab') as HTMLButtonElement;
const headersTab = document.getElementById('headers-tab') as HTMLButtonElement;
const bodyTab = document.getElementById('body-tab') as HTMLButtonElement;
const authTab = document.getElementById('auth-tab') as HTMLButtonElement;

const paramsPanel = document.getElementById('params-panel') as HTMLDivElement;
const headersPanel = document.getElementById('headers-panel') as HTMLDivElement;
const bodyPanel = document.getElementById('body-panel') as HTMLDivElement;
const authPanel = document.getElementById('auth-panel') as HTMLDivElement;

const paramsContainer = document.getElementById('params-container') as HTMLDivElement;
const headersContainer = document.getElementById('headers-container') as HTMLDivElement;
const addParamBtn = document.getElementById('add-param') as HTMLButtonElement;
const addHeaderBtn = document.getElementById('add-header') as HTMLButtonElement;

const bodyTypeSelect = document.getElementById('body-type') as HTMLSelectElement;
const bodyRawContainer = document.getElementById('body-raw-container') as HTMLDivElement;
const bodyFormContainer = document.getElementById('body-form-container') as HTMLDivElement;
const bodyJsonContainer = document.getElementById('body-json-container') as HTMLDivElement;
const bodyRawTextarea = document.getElementById('body-raw') as HTMLTextAreaElement;
const bodyJsonTextarea = document.getElementById('body-json') as HTMLTextAreaElement;
const bodyFormDataContainer = document.getElementById('body-formdata-container') as HTMLDivElement;
const addFormFieldBtn = document.getElementById('add-form-field') as HTMLButtonElement;

const authTypeSelect = document.getElementById('auth-type') as HTMLSelectElement;
const authNonePanel = document.getElementById('auth-none') as HTMLDivElement;
const authBasicPanel = document.getElementById('auth-basic') as HTMLDivElement;
const authBearerPanel = document.getElementById('auth-bearer') as HTMLDivElement;
const authApiKeyPanel = document.getElementById('auth-apikey') as HTMLDivElement;

// UI Elements - Actions
const saveRequestBtn = document.getElementById('save-request') as HTMLButtonElement;
const loadRequestBtn = document.getElementById('load-request') as HTMLButtonElement;
const viewHistoryBtn = document.getElementById('view-history') as HTMLButtonElement;
const historyModal = document.getElementById('history-modal') as HTMLDivElement;
const historyContainer = document.getElementById('history-container') as HTMLDivElement;
const clearHistoryBtn = document.getElementById('clear-history') as HTMLButtonElement;
const closeHistoryBtn = document.getElementById('close-history') as HTMLButtonElement;

// UI Elements - Projects
const projectDashboardBtn = document.getElementById('project-dashboard') as HTMLButtonElement;
const projectModal = document.getElementById('project-modal') as HTMLDivElement;
const projectListContainer = document.getElementById('project-list') as HTMLDivElement;
const createProjectBtn = document.getElementById('create-project') as HTMLButtonElement;
const closeProjectModalBtn = document.getElementById('close-project-modal') as HTMLButtonElement;
const currentProjectName = document.getElementById('current-project-name') as HTMLSpanElement;
const sidebarContainer = document.getElementById('sidebar-container') as HTMLDivElement;
const importProjectBtn = document.getElementById('import-project') as HTMLButtonElement;

// UI Elements - Project Form
const projectFormModal = document.getElementById('project-form-modal') as HTMLDivElement;
const projectFormTitle = document.getElementById('project-form-title') as HTMLHeadingElement;
const projectNameInput = document.getElementById('project-name-input') as HTMLInputElement;
const projectDescInput = document.getElementById('project-desc-input') as HTMLTextAreaElement;
const projectBaseUrlInput = document.getElementById('project-baseurl-input') as HTMLInputElement;
const projectVariablesContainer = document.getElementById('project-variables-container') as HTMLDivElement;
const addProjectVariableBtn = document.getElementById('add-project-variable') as HTMLButtonElement;
const saveProjectFormBtn = document.getElementById('save-project-form') as HTMLButtonElement;
const cancelProjectFormBtn = document.getElementById('cancel-project-form') as HTMLButtonElement;

// UI Elements - Folder
const folderModal = document.getElementById('folder-modal') as HTMLDivElement;
const folderModalTitle = document.getElementById('folder-modal-title') as HTMLHeadingElement;
const folderNameInput = document.getElementById('folder-name-input') as HTMLInputElement;
const saveFolderBtn = document.getElementById('save-folder') as HTMLButtonElement;
const cancelFolderBtn = document.getElementById('cancel-folder') as HTMLButtonElement;

// UI Elements - Folder Modal
const selectFolderModal = document.getElementById('select-folder-modal') as HTMLDivElement;
const selectProjectRoot = document.getElementById('select-project-root') as HTMLButtonElement;
const folderTreeContainer = document.getElementById('folder-tree-container') as HTMLDivElement;
const cancelFolderSelect = document.getElementById('cancel-folder-select') as HTMLButtonElement;

// State for adding request
let pendingRequestToAdd: Request | null = null;

// Breadcrumbs
const breadcrumbContainer = document.getElementById('breadcrumb-container') as HTMLDivElement;
const addToProjectBtn = document.getElementById('add-to-project') as HTMLButtonElement;

// Toggle menu elements
const hamburgerIcon = document.getElementById('hamburger-icon');
const closeIcon = document.getElementById('close-icon');
let menuVisible = false;

// Network info modal
const networkInfoBtn = document.getElementById('network-info-btn') as HTMLButtonElement;
const networkInfoModal = document.getElementById('network-info-modal') as HTMLDivElement;
const closeNetworkInfoBtn = document.getElementById('close-network-info') as HTMLButtonElement;

// Response tabs
const responseBodyTab = document.getElementById('response-body-tab') as HTMLButtonElement;
const responseHeadersTab = document.getElementById('response-headers-tab') as HTMLButtonElement;
const responseBodyPanel = document.getElementById('response-body-panel') as HTMLDivElement;
const responseHeadersPanel = document.getElementById('response-headers-panel') as HTMLDivElement;
const responseHeadersList = document.getElementById('response-headers-list') as HTMLDivElement;

// Save response request button
const saveResponseRequestBtn = document.getElementById('save-response-request') as HTMLButtonElement;

// Network info modal function
function displayNetworkInfo(networkInfo?: NetworkInfo): void {
  if (!networkInfo || Object.keys(networkInfo).length === 0) {
    networkInfoBtn.classList.add('hidden');
    return;
  }
  
  networkInfoBtn.classList.remove('hidden');
  
  const netHttpVersion = document.getElementById('net-http-version') as HTMLSpanElement;
  const netLocalAddress = document.getElementById('net-local-address') as HTMLSpanElement;
  const netRemoteAddress = document.getElementById('net-remote-address') as HTMLSpanElement;
  const netTlsProtocol = document.getElementById('net-tls-protocol') as HTMLSpanElement;
  const netCipherName = document.getElementById('net-cipher-name') as HTMLSpanElement;
  const netCertCN = document.getElementById('net-cert-cn') as HTMLSpanElement;
  const netIssuerCN = document.getElementById('net-issuer-cn') as HTMLSpanElement;
  const netValidUntil = document.getElementById('net-valid-until') as HTMLSpanElement;
  
  netHttpVersion.textContent = networkInfo.httpVersion || '-';
  netLocalAddress.textContent = networkInfo.localAddress || '-';
  netRemoteAddress.textContent = networkInfo.remoteAddress || '-';
  netTlsProtocol.textContent = networkInfo.tlsProtocol || '-';
  netCipherName.textContent = networkInfo.cipherName || '-';
  netCertCN.textContent = networkInfo.certificateCN || '-';
  netIssuerCN.textContent = networkInfo.issuerCN || '-';
  netValidUntil.textContent = networkInfo.validUntil || '-';
}

function switchResponseTab(tab: ResponseTabType): void {
  currentResponseTab = tab;
  
  // Update tab styles
  [responseBodyTab, responseHeadersTab].forEach(t => {
    t.classList.remove('border-white', 'text-white');
    t.classList.add('border-transparent', 'text-gray-400');
  });
  
  [responseBodyPanel, responseHeadersPanel].forEach(p => p.classList.add('hidden'));
  
  switch (tab) {
    case 'body':
      responseBodyTab.classList.add('border-white', 'text-white');
      responseBodyTab.classList.remove('text-gray-400', 'border-transparent');
      responseBodyPanel.classList.remove('hidden');
      break;
    case 'headers':
      responseHeadersTab.classList.add('border-white', 'text-white');
      responseHeadersTab.classList.remove('text-gray-400', 'border-transparent');
      responseHeadersPanel.classList.remove('hidden');
      break;
  }
}

function displayResponseHeaders(headers: Record<string, string>): void {
  responseHeadersList.innerHTML = '';
  
  if (!headers || Object.keys(headers).length === 0) {
    responseHeadersList.innerHTML = '<div class="text-gray-400 p-4">No headers</div>';
    return;
  }
  
  Object.entries(headers).forEach(([key, value]) => {
    const headerItem = document.createElement('div');
    headerItem.className = 'flex justify-between py-2 px-3 bg-[rgba(7,14,29,0.5)] rounded border border-gray-700';
    
    const headerKey = document.createElement('span');
    headerKey.className = 'font-semibold';
    headerKey.textContent = key;
    
    const headerValue = document.createElement('span');
    headerValue.className = 'text-white text-sm break-all ml-4';
    headerValue.textContent = value;
    
    headerItem.appendChild(headerKey);
    headerItem.appendChild(headerValue);
    responseHeadersList.appendChild(headerItem);
  });
}


// Event listener for menu toggle
document.getElementById('toggle-menu')?.addEventListener('click', () => {
  window.electron.toggleMenu();
  menuVisible = !menuVisible;
  
  if (menuVisible) {
    hamburgerIcon?.classList.add('hidden');
    closeIcon?.classList.remove('hidden');
  } else {
    hamburgerIcon?.classList.remove('hidden');
    closeIcon?.classList.add('hidden');
  }
});

document.getElementById('toggle-bearer-token')?.addEventListener('click', () => {
  const tokenInput = document.getElementById('auth-bearer-token') as HTMLInputElement;
  const eyeClosed = document.getElementById('bearer-eye-closed');
  const eyeOpen = document.getElementById('bearer-eye-open');
  
  if (!eyeClosed || !eyeOpen) return;
  
  if (tokenInput.type === 'password') {
    tokenInput.type = 'text';
    eyeClosed.classList.add('hidden');
    eyeOpen.classList.remove('hidden');
  } else {
    tokenInput.type = 'password';
    eyeClosed.classList.remove('hidden');
    eyeOpen.classList.add('hidden');
  }
});

// Tab Manager
const tabManager = new TabManager(tabsContainer, (tabId) => {
  loadTabById(tabId);
  renderSidebarUI();
});

// Project Functions
async function loadProjects(): Promise<void> {
  projects = await window.electron.loadProjects();
  renderProjectListUI();
  
  const lastProjectId = localStorage.getItem('lastActiveProject');
  if (lastProjectId) {
    const project = projects.find(p => p.id === lastProjectId);
    if (project) {
      loadProject(project.id);
    }
  }
}

async function saveProject(project: Project): Promise<void> {
  await window.electron.saveProject(project);
  hasUnsavedChanges = false;
  await loadProjects();
}

function markUnsavedChanges(): void {
  hasUnsavedChanges = true;
}

function autoSaveProject(): void {
  if (currentProject && autoSaveEnabled) {
    saveProject(currentProject);
  }
}

function debouncedSaveCurrentTab(): void {
  if (saveDebounceTimer !== null) {
    clearTimeout(saveDebounceTimer);
  }
  
  saveDebounceTimer = window.setTimeout(() => {
    // Check if we're currently in a modal or form that shouldn't trigger saves
    const activeElement = document.activeElement as HTMLElement;
    const isInModal = activeElement?.closest('#project-form-modal, #folder-modal, #history-modal, #project-modal');
    
    if (!isInModal) {
      saveCurrentTab();
      markUnsavedChanges();
      autoSaveProject();
    }
    saveDebounceTimer = null;
  }, 500);
}

function saveCurrentTab(): void {
  const tab = tabManager.getActiveTab();
  if (!tab) return;
  
  // Safety check: don't save if we're in a modal
  const activeElement = document.activeElement as HTMLElement;
  if (activeElement?.closest('#project-form-modal, #folder-modal, #history-modal, #project-modal')) {
    return;
  }
  
  const originalRequest = tab.request;
  
  const request = buildRequest(
    currentMethod,
    urlInput,
    paramsContainer,
    headersContainer,
    bodyTypeSelect,
    bodyRawTextarea,
    bodyJsonTextarea,
    bodyFormDataContainer,
    authTypeSelect,
    currentProject?.id
  );
  
  // Preserve ALL original request properties
  request.id = originalRequest.id;
  request.projectId = originalRequest.projectId;
  request.folderId = originalRequest.folderId;
  request.createdAt = originalRequest.createdAt;
  request.updatedAt = Date.now();
  
  // Update name based on URL
  updateRequestName(request);
  
  // Update the tab
  tab.request = request;
  tabManager.updateActiveTab(request, lastResponse);
  
  // Update request in project if it belongs to one
  if (currentProject && request.projectId === currentProject.id) {
    updateRequestInProject(request, currentProject);
    markUnsavedChanges();
    // Re-render sidebar to show updated request
    renderSidebarUI();
  }
  
  // Update breadcrumbs
  updateBreadcrumbs(request);
}

function updateRequestName(request: Request): void {
  if (!request.url) {
    request.name = 'Untitled Request';
    return;
  }
  
  try {
    const url = new URL(request.url);
    const path = url.pathname.split('/').filter(p => p).pop() || url.hostname;
    request.name = `${request.method} ${path}`;
  } catch {
    // If URL is incomplete, use what we have
    const urlPart = request.url.split('/').filter(p => p).pop() || request.url;
    request.name = `${request.method} ${urlPart.substring(0, 30)}`;
  }
}

// Add to project button event listener
addToProjectBtn?.addEventListener('click', () => {
  if (!currentProject) {
    alert('Please select a project first');
    return;
  }
  
  const tab = tabManager.getActiveTab();
  if (!tab) return;
  
  pendingRequestToAdd = tab.request;
  
  // Show folder selection modal
  folderTreeContainer.innerHTML = '';
  renderFolderTree(folderTreeContainer, currentProject.folders, (folderId) => {
    if (pendingRequestToAdd) {
      saveRequestToProject(pendingRequestToAdd, currentProject!, folderId);
      markUnsavedChanges();
      autoSaveProject();
      renderSidebarUI();
      
      // Update the tab's request
      tab.request.projectId = currentProject!.id;
      tab.request.folderId = folderId;
      updateBreadcrumbs(tab.request);
      
      selectFolderModal.classList.add('hidden');
      pendingRequestToAdd = null;
    }
  });
  
  selectFolderModal.classList.remove('hidden');
});

selectProjectRoot?.addEventListener('click', () => {
  if (pendingRequestToAdd && currentProject) {
    saveRequestToProject(pendingRequestToAdd, currentProject);
    markUnsavedChanges();
    autoSaveProject();
    renderSidebarUI();
    
    const tab = tabManager.getActiveTab();
    if (tab) {
      tab.request.projectId = currentProject.id;
      tab.request.folderId = undefined;
      updateBreadcrumbs(tab.request);
    }
    
    selectFolderModal.classList.add('hidden');
    pendingRequestToAdd = null;
  }
});

cancelFolderSelect?.addEventListener('click', () => {
  selectFolderModal.classList.add('hidden');
  pendingRequestToAdd = null;
});

function updateBreadcrumbs(request?: Request): void {
  const tab = tabManager.getActiveTab();
  const currentRequest = request || tab?.request;
  
  if (!currentRequest) {
    breadcrumbContainer.innerHTML = '<span class="text-gray-500 text-sm">No request</span>';
    addToProjectBtn.classList.add('hidden');
    return;
  }
  
  const context = getRequestContext(currentRequest);
  
  if (context.isInProject && currentProject && currentRequest.projectId === currentProject.id) {
    const breadcrumbs = getBreadcrumbs(currentProject, currentRequest.folderId);
    renderBreadcrumbs(breadcrumbContainer, breadcrumbs);
    addToProjectBtn.classList.add('hidden');
  } else {
    breadcrumbContainer.innerHTML = '<span class="text-gray-500 text-sm">Not in any project</span>';
    addToProjectBtn.classList.remove('hidden');
  }
}

function loadTabById(tabId: string): void {
  const tab = tabManager.getTabs().find(t => t.id === tabId);
  if (!tab) return;
  
  // Store the current focused element
  const activeElement = document.activeElement as HTMLElement;
  const wasFocused = activeElement && (
    activeElement === urlInput ||
    paramsContainer.contains(activeElement) ||
    headersContainer.contains(activeElement) ||
    bodyFormDataContainer.contains(activeElement)
  );
  
  loadRequestIntoUI(
    tab.request,
    {
      urlInput,
      paramsContainer,
      headersContainer,
      bodyTypeSelect,
      bodyRawTextarea,
      bodyJsonTextarea,
      bodyFormDataContainer,
      authTypeSelect
    },
    {
      renderParams: () => renderKeyValueList(paramsContainer, queryParams, debouncedSaveCurrentTab, true),
      renderHeaders: () => renderKeyValueList(headersContainer, headers, debouncedSaveCurrentTab, true),
      renderFormFields: () => renderKeyValueList(bodyFormDataContainer, formFields, debouncedSaveCurrentTab, true)
    },
    {
      setMethod: (method) => {
        currentMethod = method;
        updateMethodButton();
      },
      setQueryParams: (params) => { queryParams = params; },
      setHeaders: (hdrs) => { headers = hdrs; },
      setFormFields: (fields) => { formFields = fields; }
    }
  );
  
  // Restore focus if needed
  if (wasFocused && activeElement === urlInput) {
    setTimeout(() => {
      urlInput.focus();
    }, 0);
  }
  
  // Update breadcrumbs
  updateBreadcrumbs(tab.request);
  
  if (tab.response) {
    lastResponse = tab.response;
    displayResponse(tab.response, currentFormat, resultDiv, statusCodeSpan, responseTimeSpan, responseSizeSpan);
    displayNetworkInfo(tab.response.networkInfo);
    displayResponseHeaders(tab.response.headers);
  } else {
    lastResponse = null;
    resultDiv.innerHTML = '<div class="text-gray-400 p-4">No response yet</div>';
    statusCodeSpan.textContent = '-';
    statusCodeSpan.className = 'text-gray-500';
    responseTimeSpan.textContent = '-';
    responseSizeSpan.textContent = '-';
    displayNetworkInfo(undefined);
    displayResponseHeaders({});
  }
}

// Tab Management
function switchTab(tab: TabType) {
  currentTab = tab;
  
  [paramsTab, headersTab, bodyTab, authTab].forEach(t => {
    t.classList.remove('border-blue-500', 'text-white');
    t.classList.add('border-transparent', 'text-gray-400');
  });
  
  [paramsPanel, headersPanel, bodyPanel, authPanel].forEach(p => p.classList.add('hidden'));
  
  switch (tab) {
    case 'params':
      paramsTab.classList.add('border-blue-500', 'text-white');
      paramsTab.classList.remove('text-gray-400');
      paramsPanel.classList.remove('hidden');
      break;
    case 'headers':
      headersTab.classList.add('border-blue-500', 'text-white');
      headersTab.classList.remove('text-gray-400');
      headersPanel.classList.remove('hidden');
      break;
    case 'body':
      bodyTab.classList.add('border-blue-500', 'text-white');
      bodyTab.classList.remove('text-gray-400');
      bodyPanel.classList.remove('hidden');
      break;
    case 'auth':
      authTab.classList.add('border-blue-500', 'text-white');
      authTab.classList.remove('text-gray-400');
      authPanel.classList.remove('hidden');
      break;
  }
}

// Method Management
const updateMethodButton = () => {
  Object.values(methodColors).forEach(color => methodText.classList.remove(color));
  methodText.classList.add(methodColors[currentMethod]);
  methodText.textContent = currentMethod;
};

// Project UI Functions
function renderProjectListUI(): void {
  const callbacks: ProjectCallbacks = {
    onLoadProject: (projectId) => {
      loadProject(projectId);
      projectModal.classList.add('hidden');
    },
    onEditProject: (project) => {
      openProjectForm(project);
    },
    onExportProject: async (project) => {
      await window.electron.exportProject(project);
    },
    onDeleteProject: async (projectId) => {
      const project = projects.find(p => p.id === projectId);
      if (project && confirm(`Are you sure you want to delete project "${project.name}"?`)) {
        await window.electron.deleteProject(projectId);
        if (currentProject?.id === projectId) {
          currentProject = null;
          currentProjectName.textContent = 'No Project';
          renderSidebarUI();
        }
        await loadProjects();
      }
    }
  };
  
  renderProjectList(projectListContainer, projects, callbacks);
}

function openProjectForm(project?: Project): void {
  editingProjectId = project?.id || null;
  projectFormTitle.textContent = project ? 'Edit Project' : 'Create New Project';
  
  projectNameInput.value = project?.name || '';
  projectDescInput.value = project?.description || '';
  projectBaseUrlInput.value = project?.baseUrl || '';
  
  projectVariables = project?.variables ? [...project.variables] : [];
  renderKeyValueList(projectVariablesContainer, projectVariables, () => {}, true);
  
  projectModal.classList.add('hidden');
  projectFormModal.classList.remove('hidden');
}

function loadProject(projectId: string): void {
  const project = projects.find(p => p.id === projectId);
  if (!project) return;
  
  currentProject = project;
  localStorage.setItem('lastActiveProject', projectId);
  currentProjectName.textContent = project.name;
  
  renderSidebarUI();
}

function renderSidebarUI(): void {
  const tab = tabManager.getActiveTab();
  const activeRequestId = tab?.request.id;
  
  const callbacks: SidebarCallbacks = {
    onNewFolder: () => openFolderForm(),
    onNewRequest: () => createRequestInProject(),
    onAddRequestToFolder: (folderId) => createRequestInFolder(folderId),
    onAddSubfolder: (parentId) => openFolderForm(parentId),
    onDeleteFolder: (folderId) => deleteFolderUI(folderId),
    onDeleteRequest: (requestId) => deleteRequestUI(requestId),
    onLoadRequest: (request) => loadRequestIntoTab(request)
  };
  
  renderSidebar(sidebarContainer, currentProject, callbacks, activeRequestId);
}

function openFolderForm(parentId?: string): void {
  currentFolderParentId = parentId || null;
  folderModalTitle.textContent = 'Create New Folder';
  folderNameInput.value = '';
  folderModal.classList.remove('hidden');
}

function deleteFolderUI(folderId: string): void {
  if (!currentProject) return;
  if (!confirm('Delete this folder and all its contents?')) return;
  
  deleteFolder(currentProject, folderId);
  markUnsavedChanges();
  autoSaveProject();
  renderSidebarUI();
}

function createRequestInProject(): void {
  if (!currentProject) return;
  
  const request = createRequest(currentProject.id);
  request.name = `New Request ${Date.now()}`;
  addRequestToProject(currentProject, request);
  
  markUnsavedChanges();
  autoSaveProject();
  renderSidebarUI();
  
  loadRequestIntoTab(request);
}

function createRequestInFolder(folderId: string): void {
  if (!currentProject) return;
  
  const request = createRequest(currentProject.id, folderId);
  request.name = `New Request ${Date.now()}`;
  addRequestToProject(currentProject, request, folderId);
  
  markUnsavedChanges();
  autoSaveProject();
  renderSidebarUI();
  
  loadRequestIntoTab(request);
}

function loadRequestIntoTab(request: Request): void {
  const tab = tabManager.getActiveTab();
  if (tab) {
    // Load the request into the current active tab
    tab.request = { ...request };
    tab.response = null;
    loadTabById(tabManager.getActiveTabId());
  }
}

function deleteRequestUI(requestId: string): void {
  if (!currentProject) return;
  if (!confirm('Delete this request?')) return;
  
  deleteRequest(currentProject, requestId);
  
  markUnsavedChanges();
  autoSaveProject();
  renderSidebarUI();
}

// Event Listeners
newTabBtn?.addEventListener('click', () => {
  const request: Request = {
    id: Date.now().toString(),
    name: 'Untitled Request',
    method: 'GET',
    url: '',
    headers: [],
    queryParams: [],
    projectId: currentProject?.id,
    createdAt: Date.now(),
    updatedAt: Date.now()
  };
  tabManager.createTab(request);
});

urlInput?.addEventListener('input', () => debouncedSaveCurrentTab());

paramsTab?.addEventListener('click', () => switchTab('params'));
headersTab?.addEventListener('click', () => switchTab('headers'));
bodyTab?.addEventListener('click', () => switchTab('body'));
authTab?.addEventListener('click', () => switchTab('auth'));

methodButton?.addEventListener('click', (e) => {
  e.stopPropagation();
  methodDropdown.classList.toggle('hidden');
});

document.addEventListener('click', (e) => {
  if (!methodDropdown.contains(e.target as Node) && e.target !== methodButton) {
    methodDropdown.classList.add('hidden');
  }
});

const methodOptions = methodDropdown.querySelectorAll('[data-method]');
methodOptions.forEach(option => {
  option.addEventListener('click', () => {
    const method = option.getAttribute('data-method');
    if (method && isHttpMethod(method)) {
      currentMethod = method;
      updateMethodButton();
      methodDropdown.classList.add('hidden');
      debouncedSaveCurrentTab();
    }
  });
});

addParamBtn?.addEventListener('click', () => {
  syncArrayFromDOM(paramsContainer, queryParams);
  addKeyValue(queryParams, paramsContainer, debouncedSaveCurrentTab, true);
});
addHeaderBtn?.addEventListener('click', () => {
  syncArrayFromDOM(headersContainer, headers);
  addKeyValue(headers, headersContainer, debouncedSaveCurrentTab, true);
});

addFormFieldBtn?.addEventListener('click', () => {
  syncArrayFromDOM(bodyFormDataContainer, formFields);
  addKeyValue(formFields, bodyFormDataContainer, debouncedSaveCurrentTab, true);
});

bodyTypeSelect?.addEventListener('change', () => {
  const type = bodyTypeSelect.value;
  
  [bodyRawContainer, bodyFormContainer, bodyJsonContainer].forEach(c => c.classList.add('hidden'));
  
  switch (type) {
    case 'raw':
    case 'x-www-form-urlencoded':
      bodyRawContainer.classList.remove('hidden');
      break;
    case 'json':
      bodyJsonContainer.classList.remove('hidden');
      break;
    case 'form-data':
      bodyFormContainer.classList.remove('hidden');
      break;
  }
  
  debouncedSaveCurrentTab();
});

bodyRawTextarea?.addEventListener('input', debouncedSaveCurrentTab);
bodyJsonTextarea?.addEventListener('input', debouncedSaveCurrentTab);

authTypeSelect?.addEventListener('change', () => {
  const type = authTypeSelect.value;
  
  [authNonePanel, authBasicPanel, authBearerPanel, authApiKeyPanel].forEach(p => p.classList.add('hidden'));
  
  switch (type) {
    case 'none':
      authNonePanel.classList.remove('hidden');
      break;
    case 'basic':
      authBasicPanel.classList.remove('hidden');
      break;
    case 'bearer':
      authBearerPanel.classList.remove('hidden');
      break;
    case 'api-key':
      authApiKeyPanel.classList.remove('hidden');
      break;
  }
  
  debouncedSaveCurrentTab();
});

document.getElementById('auth-basic-username')?.addEventListener('input', debouncedSaveCurrentTab);
document.getElementById('auth-basic-password')?.addEventListener('input', debouncedSaveCurrentTab);
document.getElementById('auth-bearer-token')?.addEventListener('input', debouncedSaveCurrentTab);
document.getElementById('auth-apikey-key')?.addEventListener('input', debouncedSaveCurrentTab);
document.getElementById('auth-apikey-value')?.addEventListener('input', debouncedSaveCurrentTab);
document.getElementById('auth-apikey-addto')?.addEventListener('change', debouncedSaveCurrentTab);

formatSelect?.addEventListener('change', () => {
  currentFormat = formatSelect.value as DisplayFormat;
  if (lastResponse) {
    displayResponse(lastResponse, currentFormat, resultDiv, statusCodeSpan, responseTimeSpan, responseSizeSpan);
  }
});

// fetchButton?.addEventListener('click', async () => {
//   try {
//     fetchButton.disabled = true;
//     fetchButton.textContent = 'Sending...';
    
//     saveCurrentTab();
    
//     const request = buildRequest(
//       currentMethod,
//       urlInput,
//       paramsContainer,
//       headersContainer,
//       bodyTypeSelect,
//       bodyRawTextarea,
//       bodyJsonTextarea,
//       bodyFormDataContainer,
//       authTypeSelect,
//       currentProject?.id
//     );
    
//     const processedRequest = { ...request };
//     processedRequest.url = replaceVariables(request.url, currentProject);
    
//     const response = await window.electron.sendRequest(processedRequest);
    
//     lastResponse = response;
//     displayResponse(response, currentFormat, resultDiv, statusCodeSpan, responseTimeSpan, responseSizeSpan);
//     displayNetworkInfo(response.networkInfo);
//     displayResponseHeaders(response.headers);
//     saveCurrentTab();
//   } catch (error) {
//     console.error(error);
//     statusCodeSpan.textContent = 'Error';
//     statusCodeSpan.className = 'text-red-400 font-semibold';
//     resultDiv.textContent = `Error: ${(error as Error).message}`;
//     displayNetworkInfo(undefined);
//     displayResponseHeaders({});
//   } finally {
//     fetchButton.disabled = false;
//     fetchButton.textContent = 'Send';
//   }
// });
fetchButton?.addEventListener('click', async () => {
  try {
    fetchButton.disabled = true;
    fetchButton.textContent = 'Sending...';
    
    saveCurrentTab();
    
    const request = buildRequest(
      currentMethod,
      urlInput,
      paramsContainer,
      headersContainer,
      bodyTypeSelect,
      bodyRawTextarea,
      bodyJsonTextarea,
      bodyFormDataContainer,
      authTypeSelect,
      currentProject?.id
    );
    
    
    
    
    
    const processedRequest = { ...request };
    
    // Replace variables in URL
    processedRequest.url = replaceVariables(request.url, currentProject);
    
    // Replace variables in query params
    processedRequest.queryParams = request.queryParams.map(param => ({
      ...param,
      key: replaceVariables(param.key, currentProject),
      value: replaceVariables(param.value, currentProject)
    }));
    
    
    
    
    // Replace variables in headers
    processedRequest.headers = request.headers.map(header => ({
      ...header,
      key: replaceVariables(header.key, currentProject),
      value: replaceVariables(header.value, currentProject)
    }));
    
    const response = await window.electron.sendRequest(processedRequest);
    
    lastResponse = response;
    displayResponse(response, currentFormat, resultDiv, statusCodeSpan, responseTimeSpan, responseSizeSpan);
    displayNetworkInfo(response.networkInfo);
    displayResponseHeaders(response.headers);
    saveCurrentTab();
  } catch (error) {
    console.error(error);
    statusCodeSpan.textContent = 'Error';
    statusCodeSpan.className = 'text-red-400 font-semibold';
    resultDiv.textContent = `Error: ${(error as Error).message}`;
    displayNetworkInfo(undefined);
    displayResponseHeaders({});
  } finally {
    fetchButton.disabled = false;
    fetchButton.textContent = 'Send';
  }
});

saveRequestBtn?.addEventListener('click', async () => {
  const request = buildRequest(
    currentMethod,
    urlInput,
    paramsContainer,
    headersContainer,
    bodyTypeSelect,
    bodyRawTextarea,
    bodyJsonTextarea,
    bodyFormDataContainer,
    authTypeSelect,
    currentProject?.id
  );
  
  try {
    const url = new URL(request.url);
    const urlPath = url.pathname.split('/').filter(p => p).join('_') || url.hostname.replace(/\./g, '_');
    request.name = `${request.method}_${urlPath}`;
  } catch {
    request.name = `${request.method}_${Date.now()}`;
  }
  
  try {
    await window.electron.exportRequest(request);
  } catch (error) {
    console.error('Failed to export request:', error);
  }
});

loadRequestBtn?.addEventListener('click', async () => {
  try {
    const request = await window.electron.importRequest();
    
    if (!request) {
      return;
    }
    
    const tab = tabManager.getActiveTab();
    if (tab) {
      tab.request = request;
      tab.response = null;
      loadTabById(tabManager.getActiveTabId());
    }
    
  } catch (error) {
    console.error('Failed to load request:', error);
  }
});

// Event listener for save response request button
saveResponseRequestBtn?.addEventListener('click', async () => {
  if (!lastResponse) {
    alert('No response to save. Please send a request first.');
    return;
  }
  
  // Try to parse as JSON, if it fails save as text
  let contentType = 'application/json';
  let fileExtension = 'json';
  let content = lastResponse.body;
  
  try {
    // Try to parse and pretty-print JSON
    const parsed = JSON.parse(lastResponse.body);
    content = JSON.stringify(parsed, null, 2);
  } catch {
    // If not valid JSON, save as text
    contentType = 'text/plain';
    fileExtension = 'txt';
  }
  
  // Create a Blob from the response body
  const blob = new Blob([content], { type: contentType });
  const url = URL.createObjectURL(blob);
  
  // Create a temporary download link
  const a = document.createElement('a');
  a.href = url;
  
  // Generate filename based on URL and timestamp
  const tab = tabManager.getActiveTab();
  let filename = `response.${fileExtension}`;
  
  if (tab?.request.url) {
    try {
      const urlObj = new URL(tab.request.url);
      const path = urlObj.pathname.split('/').filter(p => p).pop() || urlObj.hostname.replace(/\./g, '_');
      filename = `response_${path}_${Date.now()}.${fileExtension}`;
    } catch {
      filename = `response_${Date.now()}.${fileExtension}`;
    }
  }
  
  a.download = filename;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
});

viewHistoryBtn?.addEventListener('click', async () => {
  const history = await window.electron.getHistory(20);
  
  historyContainer.innerHTML = '';
  
  history.forEach(entry => {
    const item = document.createElement('div');
    item.className = 'bg-gray-800 p-4 rounded mb-2 cursor-pointer hover:bg-gray-700';
    
    const method = entry.request.method as HttpMethod;
    const methodColor = methodColors[method] || 'text-gray-400';
    
    item.innerHTML = `
      <div class="flex justify-between items-center mb-2">
        <span class="font-semibold ${methodColor}">${method}</span>
        <span class="text-sm text-gray-400">${new Date(entry.timestamp).toLocaleString()}</span>
      </div>
      <div class="text-sm mb-1">${entry.request.url}</div>
      <div class="text-sm ${entry.response.status >= 200 && entry.response.status < 300 ? 'text-green-400' : 'text-red-400'}">
        ${entry.response.status} ${entry.response.statusText}
      </div>
    `;
    
    item.onclick = () => {
      const tab = tabManager.getActiveTab();
      if (tab) {
        tab.request = entry.request;
        tab.response = entry.response;
        loadTabById(tabManager.getActiveTabId());
      }
      historyModal.classList.add('hidden');
    };
    
    historyContainer.appendChild(item);
  });
  
  historyModal.classList.remove('hidden');
});

clearHistoryBtn?.addEventListener('click', async () => {
  if (confirm('Are you sure you want to clear all history? This cannot be undone.')) {
    await window.electron.clearHistory();
    historyContainer.innerHTML = '<div class="text-gray-400 text-center py-8">History cleared</div>';
  }
});

closeHistoryBtn?.addEventListener('click', () => {
  historyModal.classList.add('hidden');
});

projectDashboardBtn?.addEventListener('click', () => {
  projectModal.classList.remove('hidden');
  renderProjectListUI();
});

closeProjectModalBtn?.addEventListener('click', () => {
  projectModal.classList.add('hidden');
});

createProjectBtn?.addEventListener('click', () => {
  openProjectForm();
});

addProjectVariableBtn?.addEventListener('click', () => {
  addKeyValue(projectVariables, projectVariablesContainer, () => {}, true);
});

saveProjectFormBtn?.addEventListener('click', async () => {
  const name = projectNameInput.value.trim();
  if (!name) {
    alert('Project name is required');
    return;
  }
  
  // Sync the variables from DOM before saving
  syncArrayFromDOM(projectVariablesContainer, projectVariables);
  
  const project: Project = editingProjectId
    ? { ...projects.find(p => p.id === editingProjectId)!, updatedAt: Date.now() }
    : {
        id: Date.now().toString(),
        name,
        folders: [],
        requests: [],
        variables: [],
        createdAt: Date.now(),
        updatedAt: Date.now()
      };
  
  project.name = name;
  project.description = projectDescInput.value.trim();
  project.baseUrl = projectBaseUrlInput.value.trim();
  project.variables = projectVariables;  // Use the synced array directly
  
  await saveProject(project);
  
  projectFormModal.classList.add('hidden');
  projectModal.classList.remove('hidden');
  
  renderProjectListUI();
});

cancelProjectFormBtn?.addEventListener('click', () => {
  projectFormModal.classList.add('hidden');
  projectModal.classList.remove('hidden');
});

importProjectBtn?.addEventListener('click', async () => {
  const project = await window.electron.importProject();
  if (project) {
    await loadProjects();
    projectModal.classList.add('hidden');
  }
});

saveFolderBtn?.addEventListener('click', () => {
  const name = folderNameInput.value.trim();
  if (!name) {
    alert('Folder name is required');
    return;
  }
  
  if (!currentProject) return;
  
  const newFolder = createFolder(name, currentProject.id, currentFolderParentId || undefined);
  addFolderToProject(currentProject, newFolder, currentFolderParentId || undefined);
  
  markUnsavedChanges();
  autoSaveProject();
  renderSidebarUI();
  folderModal.classList.add('hidden');
});

cancelFolderBtn?.addEventListener('click', () => {
  folderModal.classList.add('hidden');
});

window.addEventListener('beforeunload', (e) => {
  if (hasUnsavedChanges && !autoSaveEnabled) {
    e.preventDefault();
    e.returnValue = '';
    
    const save = confirm('You have unsaved changes. Do you want to save your project before closing?');
    if (save && currentProject) {
      saveProject(currentProject);
    }
  }
});

// Network info modal event listeners
networkInfoBtn?.addEventListener('click', () => {
  networkInfoModal.classList.remove('hidden');
});

closeNetworkInfoBtn?.addEventListener('click', () => {
  networkInfoModal.classList.add('hidden');
});

// Response tab event listeners
responseBodyTab?.addEventListener('click', () => switchResponseTab('body'));
responseHeadersTab?.addEventListener('click', () => switchResponseTab('headers'));

// Initialize
loadProjects().then(() => {
  const request: Request = {
    id: Date.now().toString(),
    name: 'Untitled Request',
    method: 'GET',
    url: '',
    headers: [],
    queryParams: [],
    createdAt: Date.now(),
    updatedAt: Date.now()
  };
  tabManager.createTab(request);
  switchTab('params');
  switchResponseTab('body');
});
</file>

<file path="package.json">
{
  "name": "req-rep.io-electron",
  "version": "0.1.18-a",
  "description": "App to test API endpoints using curl and electron",
  "license": "ISC",
  "author": "Sigmund Frost",
  "type": "commonjs",
  "main": "dist/main/index.js",
  "scripts": {
    "start": "npm run build:css && npm run build:ts && npm run build:renderer && electron .",
    "dev": "npm run watch:css & npm run watch:ts & npm run watch:renderer & electron .",
    "build:css": "tailwindcss -i ./src/styles/input.css -o ./styles.css",
    "watch:css": "tailwindcss -i ./src/styles/input.css -o ./styles.css --watch",
    "build:ts": "tsc",
    "watch:ts": "tsc --watch",
    "build:renderer": "esbuild src/renderer/index.ts --bundle --outfile=dist/renderer/index.js --format=esm --external:electron",
    "watch:renderer": "esbuild src/renderer/index.ts --bundle --outfile=dist/renderer/index.js --format=esm --external:electron --watch",
    "test": "echo \"Error: no test specified\" && exit 1",
    "dist": "electron-builder"
  },
  "devDependencies": {
    "@types/node": "^22.10.2",
    "electron": "^39.2.2",
    "electron-builder": "^26.0.12",
    "electron-icon-builder": "^2.0.1",
    "esbuild": "^0.27.0",
    "tailwindcss": "^3.4.1",
    "typescript": "^5.7.2"
  },
  "dependencies": {
    "highlight.js": "^11.9.0"
  },
  "build": {
  "appId": "com.reqrep.io",
  "productName": "Req-Rep.io",
  "files": [
    "dist/**/*",
    "index.html",
    "styles.css",
    "node_modules/**/*",
    "build/icons/**/*",
    "build/icon.png"
  ],
  "extraResources": [
    {
      "from": "build/icons",
      "to": "build/icons",
      "filter": ["**/*"]
    }
  ],
  "asarUnpack": [
    "build/icons/**/*"
  ],
  "directories": {
    "output": "release"
  },
  "win": {
    "target": [
      {
        "target": "portable",
        "arch": [
          "x64",
          "ia32",
          "arm64"
        ]
      }
    ],
    "icon": "build/icons/win/icon.ico"
  },
  "mac": {
    "icon": "build/icons/mac/icon.icns",
    "category": "public.app-category.developer-tools"
  },
  "linux": {
    "icon": "build/icons/png/512x512.png",
    "target": ["AppImage", "deb"],
    "category": "Development"
  }
}
}
</file>

<file path="index.html">
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'"
    />
    <title>Req-Rep.io</title>
    <link href="./styles.css" rel="stylesheet">
    <link href="./node_modules/highlight.js/styles/atom-one-dark.css" rel="stylesheet">
  </head>
  <body class="bg-gray-900 text-white">
    <button id="toggle-menu" class="p-2 hover:bg-gray-800 rounded absolute top-0 right-0">
      <!-- Hamburger icon (shown by default) -->
      <svg id="hamburger-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
      </svg>
      <!-- X icon (hidden by default) -->
      <svg id="close-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
    <div class="flex h-screen">
      <!-- Sidebar -->
      <div class="w-64 p-4 bg-[rgba(7,14,29,0.5)] overflow-y-auto border-gray-700
                overflow-hidden border border-l-0 border-gray-400 rounded-r-md px-4 py-2 text-lg
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_5px_5px_-2.5px_rgba(255,255,255,0.25),_inset_-5px_0_5px_-2.5px_rgba(255,255,255,0.25),_inset_0_-5px_5px_-2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_7px_7px_-3.5px_rgba(255,255,255,0.35),_inset_-7px_0_7px_-3.5px_rgba(255,255,255,0.35),_inset_0_-7px_7px_-3.5px_rgba(255,255,255,0.35)]">
        <div class="mb-4">
          <h2 class="text-lg font-bold mb-2">Project</h2>
          <div class="text-sm text-gray-400 mb-2" id="current-project-name">No Project</div>
          <button id="project-dashboard" class="w-full px-3 py-2 text-sm overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10">
            Projects
          </button>
        </div>
        <div id="sidebar-container" class="mt-4"></div>
      </div>

      <!-- Main Content -->
      <div class="flex-1 flex flex-col px-6 mb-1 overflow-hidden">
        <div class="flex items-center">
          <img src="./build/icon.png" alt="Req-Rep.io logo" class="w-14 h-14 mt-3">
          <h1 class="text-3xl font-bold mb-4 mt-6 -ml-1">eq-Rep.io</h1>
        </div>
        
        
        <!-- Tabs Bar -->
        <div class="flex items-center gap-2 mb-4 border-b border-gray-700 pb-0">
          <div id="tabs-container" class="flex gap-1"></div>
          <button id="new-tab" class="px-3 py-2 text-gray-400 hover:text-white text-xl font-bold">+</button>
        </div>
        
        <!-- URL Bar -->
        <div class="mb-4 flex items-center gap-3 w-full">
          <div class="relative flex-shrink-0">
            <button id="method-button" class="text-green-600 font-semibold px-4 py-2 rounded cursor-pointer min-w-[120px] text-left flex items-center justify-between gap-3 bg-[rgba(7,14,29,0.7)] hover:bg-[rgba(7,14,29,0.9)] transition-all duration-300 border border-gray-700">
              <span id="method-text">GET</span>
              <svg class="w-4 h-4 flex-shrink-0" fill="none" stroke="#A9AEC1" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </button>
            <div id="method-dropdown" class="hidden absolute top-full left-0 mt-1 bg-gray-800 rounded shadow-lg border border-gray-700 min-w-[120px] z-50">
              <div data-method="GET" class="px-4 py-2 text-green-600 hover:bg-gray-700 cursor-pointer font-semibold">GET</div>
              <div data-method="POST" class="px-4 py-2 text-yellow-600 hover:bg-gray-700 cursor-pointer font-semibold">POST</div>
              <div data-method="PUT" class="px-4 py-2 text-blue-600 hover:bg-gray-700 cursor-pointer font-semibold">PUT</div>
              <div data-method="PATCH" class="px-4 py-2 text-pink-600 hover:bg-gray-700 cursor-pointer font-semibold">PATCH</div>
              <div data-method="DELETE" class="px-4 py-2 text-red-600 hover:bg-gray-700 cursor-pointer font-semibold">DELETE</div>
              <div data-method="HEAD" class="px-4 py-2 text-green-400 hover:bg-gray-700 cursor-pointer font-semibold">HEAD</div>
              <div data-method="OPTIONS" class="px-4 py-2 text-purple-600 hover:bg-gray-700 cursor-pointer font-semibold">OPTIONS</div>
            </div>
          </div>
          <input type="text" id="url" class="flex-1 text-white p-2 bg-[rgba(7,14,29,0.7)] rounded-md" placeholder="Enter URL or use {{baseUrl}}">
          <div class="flex gap-2 flex-shrink-0">
            <button id="fetch" class="font-semibold whitespace-nowrap
                  overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer
                  bg-[rgba(17,24,39,0.3)]
                  backdrop-blur-xs
                  shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                  transition-all duration-500 ease-in-out
                  hover:backdrop-blur-md
                  hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                  before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                  before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                  before:skew-x-[-25deg]
                  before:transition-all before:duration-500 before:ease-in-out
                  hover:before:left-[150%]
                  active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                  active:duration-10
            ">Send</button>
            <button id="save-request" class="whitespace-nowrap overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer
                  bg-[rgba(17,24,39,0.3)]
                  backdrop-blur-xs
                  shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                  transition-all duration-500 ease-in-out
                  hover:backdrop-blur-md
                  hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                  before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                  before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                  before:skew-x-[-25deg]
                  before:transition-all before:duration-500 before:ease-in-out
                  hover:before:left-[150%]
                  active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                  active:duration-10">Save</button>
            <button id="load-request" class="whitespace-nowrap overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer
                  bg-[rgba(17,24,39,0.3)]
                  backdrop-blur-xs
                  shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                  transition-all duration-500 ease-in-out
                  hover:backdrop-blur-md
                  hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                  before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                  before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                  before:skew-x-[-25deg]
                  before:transition-all before:duration-500 before:ease-in-out
                  hover:before:left-[150%]
                  active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                  active:duration-10">Load</button>
            <button id="view-history" class="whitespace-nowrap overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer
                  bg-[rgba(17,24,39,0.3)]
                  backdrop-blur-xs
                  shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                  transition-all duration-500 ease-in-out
                  hover:backdrop-blur-md
                  hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                  before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                  before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                  before:skew-x-[-25deg]
                  before:transition-all before:duration-500 before:ease-in-out
                  hover:before:left-[150%]
                  active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                  active:duration-10">History</button>
          </div>
        </div>

        <!-- Breadcrumbs and Context -->
        <div class="mb-3 min-h-[3rem] flex items-center justify-between
                    overflow-hidden border border-gray-400 rounded-md px-4 py-2
                    bg-[rgba(17,24,39,0.3)]
                    backdrop-blur-xs
                    shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                    transition-all duration-500 ease-in-out
                    hover:backdrop-blur-md">
          <div id="breadcrumb-container" class="flex items-center">Root</div>
          <button id="add-to-project" class="hidden text-sm
          
                overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10">
            + Add to Project
          </button>
        </div>
        
        <!-- Tabs -->
        <div class="flex border-b border-gray-700 mb-4">
          <button id="params-tab" class="px-4 py-2 font-semibold">Query Params</button>
          <button id="headers-tab" class="px-4 py-2 font-semibold">Headers</button>
          <button id="body-tab" class="px-4 py-2 font-semibold">Body</button>
          <button id="auth-tab" class="px-4 py-2 font-semibold">Auth</button>
        </div>
        
        <!-- Params Panel -->
        <div id="params-panel" class="mb-4">
          <div id="params-container" class="mb-2"></div>
          <!--Change the UI to glass here-->
          <button id="add-param" class="text-sm
                                        overflow-hidden border border-gray-400 rounded-md px-4 py-2 cursor-pointer
                                        bg-[rgba(17,24,39,0.3)]
                                        backdrop-blur-xs
                                        shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                                        transition-all duration-500 ease-in-out
                                        hover:backdrop-blur-md
                                        hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                                        before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                                        before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                                        before:skew-x-[-25deg]
                                        before:transition-all before:duration-500 before:ease-in-out
                                        hover:before:left-[150%]
                                        active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                                        active:duration-10">+ Add Parameter</button>
        </div>
        
        <!-- Headers Panel -->
        <div id="headers-panel" class="mb-4 hidden">
          <div id="headers-container" class="mb-2"></div>
          <button id="add-header" class="text-sm overflow-hidden border border-gray-400 rounded-md px-4 py-2 cursor-pointer
                                        bg-[rgba(17,24,39,0.3)]
                                        backdrop-blur-xs
                                        shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                                        transition-all duration-500 ease-in-out
                                        hover:backdrop-blur-md
                                        hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                                        before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                                        before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                                        before:skew-x-[-25deg]
                                        before:transition-all before:duration-500 before:ease-in-out
                                        hover:before:left-[150%]
                                        active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                                        active:duration-10">+ Add Header</button>
        </div>
        
        <!-- Body Panel -->
        <div id="body-panel" class="mb-4 hidden">
          <select id="body-type" class="bg-[rgba(7,14,29,0.7)] text-white p-2 rounded border border-gray-700 mb-3">
            <option value="none">None</option>
            <option value="json">JSON</option>
            <option value="raw">Raw</option>
            <option value="form-data">Form Data</option>
            <option value="x-www-form-urlencoded">x-www-form-urlencoded</option>
          </select>
          
          <div id="body-raw-container" class="hidden">
            <textarea id="body-raw" class="w-full bg-[rgba(7,14,29,0.5)] text-white p-3 rounded border border-gray-700 font-mono" rows="8" placeholder="Enter raw body"></textarea>
          </div>
          
          <div id="body-json-container" class="hidden">
            <textarea id="body-json" class="w-full bg-[rgba(7,14,29,0.5)] text-white p-3 rounded border border-gray-700 font-mono" rows="8" placeholder='{"key": "value"}'></textarea>
          </div>
          
          <div id="body-form-container" class="hidden">
            <div id="body-formdata-container" class="mb-2"></div>
            <button id="add-form-field" class="px-4 py-2 text-sm
                                              overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer
                                              bg-[rgba(17,24,39,0.3)]
                                              backdrop-blur-xs
                                              shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                                              transition-all duration-500 ease-in-out
                                              hover:backdrop-blur-md
                                              hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                                              before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                                              before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                                              before:skew-x-[-25deg]
                                              before:transition-all before:duration-500 before:ease-in-out
                                              hover:before:left-[150%]
                                              active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                                              active:duration-10">+ Add Field</button>
          </div>
        </div>
        
        <!-- Auth Panel -->
        <div id="auth-panel" class="mb-4 hidden">
          <select id="auth-type" class="bg-[rgba(7,14,29,0.7)] text-white p-2 rounded border border-gray-700 mb-3">
            <option value="none">No Auth</option>
            <option value="basic">Basic Auth</option>
            <option value="bearer">Bearer Token</option>
            <option value="api-key">API Key</option>
          </select>
          
          <div id="auth-none" class="text-gray-400">This request does not use any authorization.</div>
          
          <div id="auth-basic" class="hidden space-y-3">
            <input type="text" id="auth-basic-username" class="w-full bg-[rgba(7,14,29,0.7)] text-white p-2 rounded border border-gray-700" placeholder="Username">
            <input type="password" id="auth-basic-password" class="w-full bg-[rgba(7,14,29,0.7)] text-white p-2 rounded border border-gray-700" placeholder="Password">
          </div>
          
          <div id="auth-bearer" class="hidden">
            <div class="relative">
              <input type="password" id="auth-bearer-token" class="w-full bg-[rgba(7,14,29,0.7)] text-white p-2 pr-10 rounded border border-gray-700" placeholder="Token">
              <button type="button" id="toggle-bearer-token" class="absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-white">
                <svg id="bearer-eye-closed" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"></path>
                </svg>
                <svg id="bearer-eye-open" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                </svg>
              </button>
            </div>
          </div>
          
          <div id="auth-apikey" class="hidden space-y-3">
            <input type="text" id="auth-apikey-key" class="w-full bg-[rgba(7,14,29,0.7)] text-white p-2 rounded border border-gray-700" placeholder="Key">
            <input type="text" id="auth-apikey-value" class="w-full bg-[rgba(7,14,29,0.7)] text-white p-2 rounded border border-gray-700" placeholder="Value">
            <select id="auth-apikey-addto" class="w-full bg-[rgba(7,14,29,0.7)] text-white p-2 rounded border border-gray-700">
              <option value="header">Add to Header</option>
              <option value="query">Add to Query Params</option>
            </select>
          </div>
        </div>
        
        <!-- Response Section -->
        <div class="p-4 flex flex-col min-h-0 max-w-[calc(100vw-3rem)]
        overflow-hidden border border-gray-400 rounded-md
        bg-[rgba(17,24,39,0.3)]
        backdrop-blur-xs
        shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]">
          <div class="flex items-center justify-between mb-3 mt-1">
            <div class="flex items-center gap-4">
              <span class="text-gray-400">Status:</span>
              <span id="status-code" class="text-gray-500">-</span>
              <span class="text-gray-400">Time:</span>
              <span id="response-time" class="text-gray-500">-</span>
              <span class="text-gray-400">Size:</span>
              <span id="response-size" class="text-gray-500">-</span>
              <button id="network-info-btn" class="hidden ml-2 text-gray-400 hover:text-white transition-colors" title="Network Information">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <circle cx="12" cy="12" r="10" stroke-width="2"></circle>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2 12h20M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"></path>
                </svg>
              </button>
            </div>
            <select id="format-select" class="bg-[rgba(7,14,29,0.7)] text-white p-2 rounded border border-gray-600 cursor-pointer">
              <option value="raw">Raw</option>
              <option value="json">JSON</option>
              <option value="html">HTML</option>
              <option value="xml">XML</option>
            </select>
          </div>
          
          <!-- Response Tabs -->
          <div class="flex items-center justify-between border-b border-gray-700 mb-3">
            <div class="flex">
              <button id="response-body-tab" class="px-4 py-2 font-semibold border-b-2 border-white text-white">Body</button>
              <button id="response-headers-tab" class="px-4 py-2 font-semibold border-b-2 border-transparent text-gray-400">Headers</button>
            </div>
            <button id="save-response-request" class="text-sm overflow-hidden border border-gray-400 rounded-md px-3 py-1 cursor-pointer
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10">
              Save response
            </button>
          </div>
          
          <!-- Body Panel -->
          <div id="response-body-panel" class="flex-1 min-h-0 overflow-auto">
            <div id="result" class="rounded"></div>
          </div>
          
          <!-- Headers Panel -->
          <div id="response-headers-panel" class="hidden flex-1 min-h-0 overflow-auto">
            <div id="response-headers-list" class="space-y-2"></div>
          </div>
        </div>
      </div>
    </div>
    
    <!--Change the UI to glass here-->
    <!-- History Modal -->
    <div id="history-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-gray-900 rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-hidden flex flex-col">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-2xl font-bold">Request History</h2>
          <div class="flex gap-2">
            <!--Change the UI to glass here-->
            <button id="clear-history" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded text-sm">Clear History</button>
            <!--Change the UI to glass here-->
            <button id="close-history" class="text-gray-400 hover:text-white text-2xl">&times;</button>
          </div>
        </div>
        <!--Change the UI to glass here-->
        <div id="history-container" class="flex-1 overflow-auto"></div>
      </div>
    </div>

    <!-- Project Modal -->
    <div id="project-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-gray-900 rounded-lg p-6 max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden flex flex-col">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-2xl font-bold">Projects</h2>
          <!--Change the UI to glass here-->
          <div class="flex gap-2">
            <!--Change the UI to glass here-->
            <button id="import-project" class="px-4 py-2 text-sm overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10">Import Project</button>
            <!--Change the UI to glass here-->
            <button id="create-project" class="px-4 py-2 text-sm overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10">Create Project</button>
            <!--Change the UI to glass here-->
            <button id="close-project-modal" class="text-gray-400 hover:text-white text-2xl">&times;</button>
          </div>
        </div>
        <div id="project-list" class="flex-1 overflow-auto"></div>
      </div>
    </div>

    <!-- Project Form Modal -->
    <div id="project-form-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-gray-900 rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-hidden flex flex-col">
        <h2 id="project-form-title" class="text-2xl font-bold mb-4">Create New Project</h2>
        
        <div class="flex-1 overflow-auto mb-4">
          <div class="mb-4">
            <label class="block text-sm font-semibold mb-2">Project Name *</label>
            <!--Change the UI to glass here-->
            <input type="text" id="project-name-input" class="w-full bg-[rgba(7,14,29,0.7)] text-white p-2 rounded border border-gray-700" placeholder="My Project">
          </div>
          
          <div class="mb-4">
            <label class="block text-sm font-semibold mb-2">Description</label>
            <!--Change the UI to glass here-->
            <textarea id="project-desc-input" class="w-full bg-[rgba(7,14,29,0.7)] text-white p-2 rounded border border-gray-700" rows="3" placeholder="Project description"></textarea>
          </div>
          
          <div class="mb-4">
            <label class="block text-sm font-semibold mb-2">Base URL</label>
            <input type="text" id="project-baseurl-input" class="w-full bg-[rgba(7,14,29,0.7)] text-white p-2 rounded border border-gray-700" placeholder="http://localhost:8080">
            <p class="text-xs text-gray-400 mt-1">Use {{baseUrl}} in your requests to reference this URL</p>
          </div>
          
          <div class="mb-4">
            <label class="block text-sm font-semibold mb-2">Environment Variables</label>
            <div id="project-variables-container" class="mb-2"></div>
            <button id="add-project-variable" class="px-4 py-2 text-sm overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10">+ Add Variable</button>
            <p class="text-xs text-gray-400 mt-1">Use {{variableName}} in your requests. Mark sensitive data (tokens, passwords) with the lock icon.</p>
          </div>
        </div>
        
        <div class="flex gap-2 justify-end">
          <button id="cancel-project-form" class="px-4 py-2 overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10">Cancel</button>
          <button id="save-project-form" class="px-4 py-2 overflow-hidden border border-gray-400 rounded-md px-4 py-2 text-lg cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10">Save Project</button>
        </div>
      </div>
    </div>

    <!-- Folder Modal -->
    <div id="folder-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-gray-900 rounded-lg p-6 max-w-md w-full mx-4">
        <h2 id="folder-modal-title" class="text-2xl font-bold mb-4">Create New Folder</h2>
        
        <div class="mb-4">
          <label class="block text-sm font-semibold mb-2">Folder Name *</label>
          <input type="text" id="folder-name-input" class="w-full bg-gray-800 text-white p-2 rounded border border-gray-700" placeholder="Authentication">
        </div>
        
        <div class="flex gap-2 justify-end">
          <button id="cancel-folder" class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded">Cancel</button>
          <button id="save-folder" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">Create Folder</button>
        </div>
      </div>
    </div>

    <!-- Select Folder Modal -->
    <div id="select-folder-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-gray-900 rounded-lg p-6 max-w-md w-full mx-4 max-h-[60vh] overflow-hidden flex flex-col">
        <h2 class="text-2xl font-bold mb-4">Select Folder</h2>
        
        <div class="flex-1 overflow-auto mb-4">
          <button id="select-project-root" class="w-full bg-[rgba(7,14,29,0.5)] hover:bg-gray-800 p-3 rounded mb-2 text-left transition-all duration-300">
            <svg class="w-5 h-5 inline-block mb-1" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M3 8.2C3 7.07989 3 6.51984 3.21799 6.09202C3.40973 5.71569 3.71569 5.40973 4.09202 5.21799C4.51984 5 5.0799 5 6.2 5H9.67452C10.1637 5 10.4083 5 10.6385 5.05526C10.8425 5.10425 11.0376 5.18506 11.2166 5.29472C11.4184 5.4184 11.5914 5.59135 11.9373 5.93726L12.0627 6.06274C12.4086 6.40865 12.5816 6.5816 12.7834 6.70528C12.9624 6.81494 13.1575 6.89575 13.3615 6.94474C13.5917 7 13.8363 7 14.3255 7H17.8C18.9201 7 19.4802 7 19.908 7.21799C20.2843 7.40973 20.5903 7.71569 20.782 8.09202C21 8.51984 21 9.0799 21 10.2V15.8C21 16.9201 21 17.4802 20.782 17.908C20.5903 18.2843 20.2843 18.5903 19.908 18.782C19.4802 19 18.9201 19 17.8 19H6.2C5.07989 19 4.51984 19 4.09202 18.782C3.71569 18.5903 3.40973 18.2843 3.21799 17.908C3 17.4802 3 16.9201 3 15.8V8.2Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg> <span class="font-semibold">Project Root</span>
          </button>
          <div id="folder-tree-container"></div>
        </div>
        
        <div class="flex gap-2 justify-end">
          <button id="cancel-folder-select" class="px-4 py-2 overflow-hidden border border-gray-400 rounded-md text-md cursor-pointer relative
                bg-[rgba(17,24,39,0.3)]
                backdrop-blur-xs
                shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_5px_2.5px_rgba(255,255,255,0.25)]
                transition-all duration-500 ease-in-out
                hover:backdrop-blur-md
                hover:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_10px_5px_rgba(255,255,255,0.5)]
                before:content-[''] before:absolute before:top-0 before:left-[-100%] before:w-[50%] before:h-full
                before:bg-gradient-to-r before:from-transparent before:via-white/40 before:to-transparent
                before:skew-x-[-25deg]
                before:transition-all before:duration-500 before:ease-in-out
                hover:before:left-[150%]
                active:shadow-[0_8px_32px_rgba(0,0,0,0.1),_inset_0_1px_0_rgba(255,255,255,0.5),_inset_0_-1px_0_rgba(255,255,255,0.1),_inset_0_0_15px_7.5px_rgba(255,255,255,0.75)]
                active:duration-10">Cancel</button>
        </div>
      </div>
    </div>

    <!-- Network Info Modal -->
    <div id="network-info-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <div class="bg-gray-900 rounded-lg p-6 max-w-lg w-full mx-4">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-2xl font-bold">Network Information</h2>
          <button id="close-network-info" class="text-gray-400 hover:text-white text-2xl">&times;</button>
        </div>
        <div id="network-info-content" class="space-y-3">
          <div class="flex justify-between py-2 border-b border-gray-700">
            <span class="text-gray-400">HTTP Version:</span>
            <span id="net-http-version" class="text-white">-</span>
          </div>
          <div class="flex justify-between py-2 border-b border-gray-700">
            <span class="text-gray-400">Local Address:</span>
            <span id="net-local-address" class="text-white">-</span>
          </div>
          <div class="flex justify-between py-2 border-b border-gray-700">
            <span class="text-gray-400">Remote Address:</span>
            <span id="net-remote-address" class="text-white">-</span>
          </div>
          <div class="flex justify-between py-2 border-b border-gray-700">
            <span class="text-gray-400">TLS Protocol:</span>
            <span id="net-tls-protocol" class="text-white">-</span>
          </div>
          <div class="flex justify-between py-2 border-b border-gray-700">
            <span class="text-gray-400">Cipher Name:</span>
            <span id="net-cipher-name" class="text-white text-sm">-</span>
          </div>
          <div class="flex justify-between py-2 border-b border-gray-700">
            <span class="text-gray-400">Certificate CN:</span>
            <span id="net-cert-cn" class="text-white text-sm">-</span>
          </div>
          <div class="flex justify-between py-2 border-b border-gray-700">
            <span class="text-gray-400">Issuer CN:</span>
            <span id="net-issuer-cn" class="text-white text-sm">-</span>
          </div>
          <div class="flex justify-between py-2">
            <span class="text-gray-400">Valid Until:</span>
            <span id="net-valid-until" class="text-white text-sm">-</span>
          </div>
        </div>
      </div>
    </div>
    
    <script type="module" src="./dist/renderer/index.js"></script>
  </body>
</html>
</file>

</files>
